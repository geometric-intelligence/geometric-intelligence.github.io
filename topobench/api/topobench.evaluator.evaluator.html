
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>topobench.evaluator.evaluator module &#8212; TopoBench latest documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=8dc79e66" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=c6e86fd7"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/topobench.evaluator.evaluator';</script>
    <link rel="canonical" href="https://geometric-intelligence.github.io/topobench/api/topobench.evaluator.evaluator.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="topobench.loss package" href="topobench.loss.html" />
    <link rel="prev" title="topobench.evaluator.base module" href="topobench.evaluator.base.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="latest" />
    <meta name="docbuild:last-update" content="Oct 27, 2025, 11:36:06 PM"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">TopoBench latest documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tdl-challenge/index.html">
    TAG-DS TDL Challenge 2025
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tdl-challenge/index.html">
    TAG-DS TDL Challenge 2025
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">API Reference</a></li>
    
    
    <li class="breadcrumb-item"><a href="topobench.html" class="nav-link">topobench package</a></li>
    
    
    <li class="breadcrumb-item"><a href="topobench.evaluator.html" class="nav-link">topobench.evaluator package</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">topobench.evaluator.evaluator module</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-topobench.evaluator.evaluator">
<span id="topobench-evaluator-evaluator-module"></span><h1>topobench.evaluator.evaluator module<a class="headerlink" href="#module-topobench.evaluator.evaluator" title="Link to this heading">#</a></h1>
<p>This module contains the Evaluator class that is responsible for computing the metrics.</p>
<dl class="py class">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.AbstractEvaluator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AbstractEvaluator</span></span><a class="headerlink" href="#topobench.evaluator.evaluator.AbstractEvaluator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="topobench.optimizer.base.html#topobench.optimizer.base.ABC" title="abc.ABC"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Abstract class for the evaluator class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.AbstractEvaluator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.AbstractEvaluator.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.AbstractEvaluator.compute">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.AbstractEvaluator.compute" title="Link to this definition">#</a></dt>
<dd><p>Compute the metrics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.AbstractEvaluator.reset">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.AbstractEvaluator.reset" title="Link to this definition">#</a></dt>
<dd><p>Reset the metrics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.AbstractEvaluator.update">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.AbstractEvaluator.update" title="Link to this definition">#</a></dt>
<dd><p>Update the metrics with the model output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_out</strong><span class="classifier">dict</span></dt><dd><p>The model output.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MetricCollection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">additional_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postfix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleDict</span></code></p>
<p>MetricCollection class can be used to chain metrics that have the same call pattern into one single class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<a class="reference internal" href="topobench.evaluator.metrics.example.html#topobench.evaluator.metrics.example.Metric" title="torchmetrics.metric.Metric"><em>Metric</em></a><em> | </em><a class="reference internal" href="#topobench.evaluator.evaluator.MetricCollection" title="topobench.evaluator.evaluator.MetricCollection"><em>MetricCollection</em></a><em> | </em><a class="reference internal" href="topobench.utils.rich_utils.html#topobench.utils.rich_utils.Sequence" title="collections.abc.Sequence"><em>Sequence</em></a><em>[</em><a class="reference internal" href="topobench.evaluator.metrics.example.html#topobench.evaluator.metrics.example.Metric" title="torchmetrics.metric.Metric"><em>Metric</em></a><em> | </em><a class="reference internal" href="#topobench.evaluator.evaluator.MetricCollection" title="topobench.evaluator.evaluator.MetricCollection"><em>MetricCollection</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference internal" href="topobench.evaluator.metrics.example.html#topobench.evaluator.metrics.example.Metric" title="torchmetrics.metric.Metric"><em>Metric</em></a><em> | </em><a class="reference internal" href="#topobench.evaluator.evaluator.MetricCollection" title="topobench.evaluator.evaluator.MetricCollection"><em>MetricCollection</em></a><em>]</em>) – <p>One of the following</p>
<ul>
<li><p>list or tuple (sequence): if metrics are passed in as a list or tuple, will use the metrics class name
as key for output dict. Therefore, two metrics of the same class cannot be chained this way.</p></li>
<li><p>arguments: similar to passing in as a list, metrics passed in as arguments will use their metric
class name as key for the output dict.</p></li>
<li><p>dict: if metrics are passed in as a dict, will use each key in the dict as key for output dict.
Use this format if you want to chain together multiple of the same metric with different parameters.
Note that the keys in the output dict will be sorted alphabetically.</p></li>
</ul>
</p></li>
<li><p><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>None</em>) – a string to append in front of the keys of the output dict</p></li>
<li><p><strong>postfix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>None</em>) – a string to append after the keys of the output dict</p></li>
<li><p><strong>compute_groups</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>]</em><em>]</em>) – By default the MetricCollection will try to reduce the computations needed for the metrics in the collection
by checking if they belong to the same <strong>compute group</strong>. All metrics in a compute group share the same
metric state and are therefore only different in their compute step e.g. accuracy, precision and recall
can all be computed from the true positives/negatives and false positives/negatives. By default,
this argument is <code class="docutils literal notranslate"><span class="pre">True</span></code> which enables this feature. Set this argument to <cite>False</cite> for disabling
this behaviour. Can also be set to a list of lists of metrics for setting the compute groups yourself.</p></li>
</ul>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The compute groups feature can significantly speedup the calculation of metrics under the right conditions.
First, the feature is only available when calling the <code class="docutils literal notranslate"><span class="pre">update</span></code> method and not when calling <code class="docutils literal notranslate"><span class="pre">forward</span></code> method
due to the internal logic of <code class="docutils literal notranslate"><span class="pre">forward</span></code> preventing this. Secondly, since we compute groups share metric
states by reference, calling <code class="docutils literal notranslate"><span class="pre">.items()</span></code>, <code class="docutils literal notranslate"><span class="pre">.values()</span></code> etc. on the metric collection will break this
reference and a copy of states are instead returned in this case (reference will be reestablished on the next
call to <code class="docutils literal notranslate"><span class="pre">update</span></code>). Do note that for the time being that if you are manually specifying compute groups in
nested collections, these are not compatible with the compute groups of the parent collection and will be
overridden.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Metric collections can be nested at initialization (see last example) but the output of the collection will
still be a single flatten dictionary combining the prefix and postfix arguments from the nested collection.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If one of the elements of <code class="docutils literal notranslate"><span class="pre">metrics</span></code> is not an instance of <code class="docutils literal notranslate"><span class="pre">pl.metrics.Metric</span></code>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If two elements in <code class="docutils literal notranslate"><span class="pre">metrics</span></code> have the same <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">metrics</span></code> is not a <code class="docutils literal notranslate"><span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">tuple</span></code> or a <code class="docutils literal notranslate"><span class="pre">dict</span></code>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">metrics</span></code> is <code class="docutils literal notranslate"><span class="pre">dict</span></code> and additional_metrics are passed in.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">prefix</span></code> is set and it is not a string.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">postfix</span></code> is set and it is not a string.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Example::</dt><dd><p>In the most basic case, the metrics can be passed in as a list or tuple. The keys of the output dict will be
the same as the class name of the metric:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torchmetrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">MetricCollection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torchmetrics.regression</span><span class="w"> </span><span class="kn">import</span> <span class="n">MeanSquaredError</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torchmetrics.classification</span><span class="w"> </span><span class="kn">import</span> <span class="n">MulticlassAccuracy</span><span class="p">,</span> <span class="n">MulticlassPrecision</span><span class="p">,</span> <span class="n">MulticlassRecall</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preds</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="n">MetricCollection</span><span class="p">([</span><span class="n">MulticlassAccuracy</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">),</span>
<span class="gp">... </span>                            <span class="n">MulticlassPrecision</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">),</span>
<span class="gp">... </span>                            <span class="n">MulticlassRecall</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>  
<span class="go">{&#39;MulticlassAccuracy&#39;: tensor(0.1250),</span>
<span class="go"> &#39;MulticlassPrecision&#39;: tensor(0.0667),</span>
<span class="go"> &#39;MulticlassRecall&#39;: tensor(0.1111)}</span>
</pre></div>
</div>
</dd>
<dt>Example::</dt><dd><p>Alternatively, metrics can be passed in as arguments. The keys of the output dict will be the same as the
class name of the metric:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="n">MetricCollection</span><span class="p">(</span><span class="n">MulticlassAccuracy</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="n">MulticlassPrecision</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="n">MulticlassRecall</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>  
<span class="go">{&#39;MulticlassAccuracy&#39;: tensor(0.1250),</span>
<span class="go"> &#39;MulticlassPrecision&#39;: tensor(0.0667),</span>
<span class="go"> &#39;MulticlassRecall&#39;: tensor(0.1111)}</span>
</pre></div>
</div>
</dd>
<dt>Example::</dt><dd><p>If multiple of the same metric class (with different parameters) should be chained together, metrics can be
passed in as a dict and the output dict will have the same keys as the input dict:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="n">MetricCollection</span><span class="p">({</span><span class="s1">&#39;micro_recall&#39;</span><span class="p">:</span> <span class="n">MulticlassRecall</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">),</span>
<span class="gp">... </span>                            <span class="s1">&#39;macro_recall&#39;</span><span class="p">:</span> <span class="n">MulticlassRecall</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">same_metric</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">metrics</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">target</span><span class="p">))</span>
<span class="go">{&#39;macro_recall&#39;: tensor(0.1111), &#39;micro_recall&#39;: tensor(0.1250)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">same_metric</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">target</span><span class="p">))</span>
<span class="go">{&#39;macro_recall&#39;: tensor(0.1111), &#39;micro_recall&#39;: tensor(0.1250)}</span>
</pre></div>
</div>
</dd>
<dt>Example::</dt><dd><p>Metric collections can also be nested up to a single time. The output of the collection will still be a single
dict with the prefix and postfix arguments from the nested collection:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="n">MetricCollection</span><span class="p">([</span>
<span class="gp">... </span>    <span class="n">MetricCollection</span><span class="p">([</span>
<span class="gp">... </span>        <span class="n">MulticlassAccuracy</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">MulticlassPrecision</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="p">],</span> <span class="n">postfix</span><span class="o">=</span><span class="s1">&#39;_macro&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">MetricCollection</span><span class="p">([</span>
<span class="gp">... </span>        <span class="n">MulticlassAccuracy</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">MulticlassPrecision</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="p">],</span> <span class="n">postfix</span><span class="o">=</span><span class="s1">&#39;_micro&#39;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">],</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;valmetrics/&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">metrics</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">target</span><span class="p">))</span>  
<span class="go">{&#39;valmetrics/MulticlassAccuracy_macro&#39;: tensor(0.1111),</span>
<span class="go"> &#39;valmetrics/MulticlassAccuracy_micro&#39;: tensor(0.1250),</span>
<span class="go"> &#39;valmetrics/MulticlassPrecision_macro&#39;: tensor(0.0667),</span>
<span class="go"> &#39;valmetrics/MulticlassPrecision_micro&#39;: tensor(0.1250)}</span>
</pre></div>
</div>
</dd>
<dt>Example::</dt><dd><p>The <cite>compute_groups</cite> argument allow you to specify which metrics should share metric state. By default, this
will automatically be derived but can also be set manually.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="n">MetricCollection</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">MulticlassRecall</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">MulticlassPrecision</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">MeanSquaredError</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">compute_groups</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;MulticlassRecall&#39;</span><span class="p">,</span> <span class="s1">&#39;MulticlassPrecision&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;MeanSquaredError&#39;</span><span class="p">]]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">compute</span><span class="p">())</span>
<span class="go">{&#39;MeanSquaredError&#39;: tensor(2.3750), &#39;MulticlassPrecision&#39;: tensor(0.0667), &#39;MulticlassRecall&#39;: tensor(0.1111)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">compute_groups</span><span class="p">)</span>
<span class="go">{0: [&#39;MulticlassRecall&#39;, &#39;MulticlassPrecision&#39;], 1: [&#39;MeanSquaredError&#39;]}</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">additional_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postfix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.add_metrics">
<span class="sig-name descname"><span class="pre">add_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">additional_metrics</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.add_metrics" title="Link to this definition">#</a></dt>
<dd><p>Add new metrics to Metric Collection.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postfix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.clone" title="Link to this definition">#</a></dt>
<dd><p>Make a copy of the metric collection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>None</em>) – a string to append in front of the metric keys</p></li>
<li><p><strong>postfix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>None</em>) – a string to append after the keys of the output dict.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.compute" title="Link to this definition">#</a></dt>
<dd><p>Compute the result for each metric in the collection.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.forward" title="Link to this definition">#</a></dt>
<dd><p>Call forward for each metric sequentially.</p>
<p>Positional arguments (args) will be passed to every metric in the collection, while keyword arguments (kwargs)
will be filtered based on the signature of the individual metric.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.items" title="Link to this definition">#</a></dt>
<dd><p>Return an iterable of the ModuleDict key/value pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keep_base</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to add prefix/postfix on the collection.</p></li>
<li><p><strong>copy_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – If metric states should be copied between metrics in the same compute group or just passed by reference</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.keys" title="Link to this definition">#</a></dt>
<dd><p>Return an iterable of the ModuleDict key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>keep_base</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to add prefix/postfix on the items collection.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.persistent">
<span class="sig-name descname"><span class="pre">persistent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.persistent" title="Link to this definition">#</a></dt>
<dd><p>Change if metric states should be saved to its state_dict after initialization.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">together</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.plot" title="Link to this definition">#</a></dt>
<dd><p>Plot a single or multiple values from the metric.</p>
<p>The plot method has two modes of operation. If argument <cite>together</cite> is set to <cite>False</cite> (default), the <cite>.plot</cite>
method of each metric will be called individually and the result will be list of figures. If <cite>together</cite> is set
to <cite>True</cite>, the values of all metrics will instead be plotted in the same figure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> | </em><a class="reference internal" href="topobench.utils.rich_utils.html#topobench.utils.rich_utils.Sequence" title="collections.abc.Sequence"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>] </em><em>| </em><em>None</em>) – Either a single result from calling <cite>metric.forward</cite> or <cite>metric.compute</cite> or a list of these results.
If no value is provided, will automatically call <cite>metric.compute</cite> and plot that result.</p></li>
<li><p><strong>ax</strong> (<em>Axes</em><em> | </em><a class="reference internal" href="topobench.utils.rich_utils.html#topobench.utils.rich_utils.Sequence" title="collections.abc.Sequence"><em>Sequence</em></a><em>[</em><em>Axes</em><em>] </em><em>| </em><em>None</em>) – Either a single instance of matplotlib axis object or an sequence of matplotlib axis objects. If
provided, will add the plots to the provided axis objects. If not provided, will create a new. If
argument <cite>together</cite> is set to <cite>True</cite>, a single object is expected. If <cite>together</cite> is set to <cite>False</cite>,
the number of axis objects needs to be the same length as the number of metrics in the collection.</p></li>
<li><p><strong>together</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – If <cite>True</cite>, will plot all metrics in the same axis. If <cite>False</cite>, will plot each metric in a separate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either install tuple of Figure and Axes object or an sequence of tuples with Figure and Axes object for each
metric in the collection.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ModuleNotFoundError" title="(in Python v3.14)"><strong>ModuleNotFoundError</strong></a> – If <cite>matplotlib</cite> is not installed</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <cite>together</cite> is not an bool</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <cite>ax</cite> is not an instance of matplotlib axis object or a sequence of matplotlib axis objects</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="topobench.utils.rich_utils.html#topobench.utils.rich_utils.Sequence" title="collections.abc.Sequence"><em>Sequence</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>[<em>Figure</em>, <em>Axes</em> | <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.reset" title="Link to this definition">#</a></dt>
<dd><p>Call reset for each metric sequentially.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.set_dtype">
<span class="sig-name descname"><span class="pre">set_dtype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dst_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.set_dtype" title="Link to this definition">#</a></dt>
<dd><p>Transfer all metric state to specific dtype. Special version of standard <cite>type</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dst_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>dtype</em>) – the desired type as <code class="docutils literal notranslate"><span class="pre">torch.dtype</span></code> or string.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.update" title="Link to this definition">#</a></dt>
<dd><p>Call update for each metric sequentially.</p>
<p>Positional arguments (args) will be passed to every metric in the collection, while keyword arguments (kwargs)
will be filtered based on the signature of the individual metric.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">copy_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.values" title="Link to this definition">#</a></dt>
<dd><p>Return an iterable of the ModuleDict values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>copy_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – If metric states should be copied between metrics in the same compute group or just passed by reference</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.compute_groups">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_groups</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.compute_groups" title="Link to this definition">#</a></dt>
<dd><p>Return a dict with the current compute groups in the collection.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.MetricCollection.metric_state">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metric_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="topobench.utils.utils.html#topobench.utils.utils.Any" title="typing.Any"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#topobench.evaluator.evaluator.MetricCollection.metric_state" title="Link to this definition">#</a></dt>
<dd><p>Get the current state of the metric.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.TBEvaluator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TBEvaluator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.TBEvaluator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="topobench.evaluator.base.html#topobench.evaluator.base.AbstractEvaluator" title="topobench.evaluator.base.AbstractEvaluator"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractEvaluator</span></code></a></p>
<p>Evaluator class that is responsible for computing the metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>task</strong><span class="classifier">str</span></dt><dd><p>The task type. It can be either “classification” or “regression”.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">dict</span></dt><dd><p>Additional arguments for the class. The arguments depend on the task.
In “classification” scenario, the following arguments are expected:
- num_classes (int): The number of classes.
- metrics (list[str]): A list of classification metrics to be computed.
In “regression” scenario, the following arguments are expected:
- metrics (list[str]): A list of regression metrics to be computed.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.TBEvaluator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.TBEvaluator.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.TBEvaluator.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.TBEvaluator.compute" title="Link to this definition">#</a></dt>
<dd><p>Compute the metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>dict</dt><dd><p>Dictionary containing the computed metrics.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.TBEvaluator.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.TBEvaluator.reset" title="Link to this definition">#</a></dt>
<dd><p>Reset the metrics.</p>
<p>This method should be called after each epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="topobench.evaluator.evaluator.TBEvaluator.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#topobench.evaluator.evaluator.TBEvaluator.update" title="Link to this definition">#</a></dt>
<dd><p>Update the metrics with the model output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_out</strong><span class="classifier">dict</span></dt><dd><p>The model output. It should contain the following keys:
- logits : torch.Tensor
The model predictions.
- labels : torch.Tensor
The ground truth labels.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ValueError</dt><dd><p>If the task is not valid.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="topobench.evaluator.base.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">topobench.evaluator.base module</p>
      </div>
    </a>
    <a class="right-next"
       href="topobench.loss.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">topobench.loss package</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.AbstractEvaluator"><code class="docutils literal notranslate"><span class="pre">AbstractEvaluator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.AbstractEvaluator.__init__"><code class="docutils literal notranslate"><span class="pre">AbstractEvaluator.__init__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.AbstractEvaluator.compute"><code class="docutils literal notranslate"><span class="pre">AbstractEvaluator.compute()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.AbstractEvaluator.reset"><code class="docutils literal notranslate"><span class="pre">AbstractEvaluator.reset()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.AbstractEvaluator.update"><code class="docutils literal notranslate"><span class="pre">AbstractEvaluator.update()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection"><code class="docutils literal notranslate"><span class="pre">MetricCollection</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.__init__"><code class="docutils literal notranslate"><span class="pre">MetricCollection.__init__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.add_metrics"><code class="docutils literal notranslate"><span class="pre">MetricCollection.add_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.clone"><code class="docutils literal notranslate"><span class="pre">MetricCollection.clone()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.compute"><code class="docutils literal notranslate"><span class="pre">MetricCollection.compute()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.forward"><code class="docutils literal notranslate"><span class="pre">MetricCollection.forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.items"><code class="docutils literal notranslate"><span class="pre">MetricCollection.items()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.keys"><code class="docutils literal notranslate"><span class="pre">MetricCollection.keys()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.persistent"><code class="docutils literal notranslate"><span class="pre">MetricCollection.persistent()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.plot"><code class="docutils literal notranslate"><span class="pre">MetricCollection.plot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.reset"><code class="docutils literal notranslate"><span class="pre">MetricCollection.reset()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.set_dtype"><code class="docutils literal notranslate"><span class="pre">MetricCollection.set_dtype()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.update"><code class="docutils literal notranslate"><span class="pre">MetricCollection.update()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.values"><code class="docutils literal notranslate"><span class="pre">MetricCollection.values()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.compute_groups"><code class="docutils literal notranslate"><span class="pre">MetricCollection.compute_groups</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.MetricCollection.metric_state"><code class="docutils literal notranslate"><span class="pre">MetricCollection.metric_state</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.TBEvaluator"><code class="docutils literal notranslate"><span class="pre">TBEvaluator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.TBEvaluator.__init__"><code class="docutils literal notranslate"><span class="pre">TBEvaluator.__init__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.TBEvaluator.compute"><code class="docutils literal notranslate"><span class="pre">TBEvaluator.compute()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.TBEvaluator.reset"><code class="docutils literal notranslate"><span class="pre">TBEvaluator.reset()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topobench.evaluator.evaluator.TBEvaluator.update"><code class="docutils literal notranslate"><span class="pre">TBEvaluator.update()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Topological-Intelligence Team, Inc..
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>