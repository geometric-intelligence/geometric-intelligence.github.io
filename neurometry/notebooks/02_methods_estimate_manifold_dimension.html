
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Estimate Neural Dimensions &#8212; neurometry latest documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=c6e86fd7"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/02_methods_estimate_manifold_dimension';</script>
    <link rel="canonical" href="https://geometric-intelligence.github.io/neurometry/notebooks/02_methods_estimate_manifold_dimension.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Estimate Neural Topology" href="03_methods_estimate_manifold_topology.html" />
    <link rel="prev" title="Create Synthetic Neural Manifolds" href="01_methods_create_synthetic_data.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="latest" />
    <meta name="docbuild:last-update" content="Jun 24, 2025, 6:33:25â€¯PM"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">neurometry latest documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../tutorials/index.html">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../tutorials/index.html">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_methods_create_synthetic_data.html">Create Synthetic Neural Manifolds</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Estimate Neural Dimensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_methods_estimate_manifold_topology.html">Estimate Neural Topology</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_methods_estimate_manifold_geometry.html">Estimate Neural Manifold Immersion</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_analyze_task_optimized_rnn.html">Analyze a Task-Optimized RNN model of Medial Entorhinal Cortex</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_analyze_digital_twin_V4.html">Analyze a Digital Twin model of Macaque Visual Cortex area V4</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_analyze_electrophys_hippocampus.html">Analyze Electrophysiological Recordings of Rodent Hippocampus</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../tutorials/index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Estimate Neural Dimensions</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="admonition note">
  <p>Notebook source code:
    <a class="reference external" href="https://github.com/geometric-intelligence/neurometry/blob/main/notebooks/02_methods_estimate_manifold_dimension.ipynb">notebooks/02_methods_estimate_manifold_dimension.ipynb</a>
  </p>
</div><section id="Estimate-Neural-Dimensions">
<h1>Estimate Neural Dimensions<a class="headerlink" href="#Estimate-Neural-Dimensions" title="Link to this heading">#</a></h1>
<p>This notebook explains how to use the module <code class="docutils literal notranslate"><span class="pre">dimension</span></code> to estimate the dimension (extrinsic or intrinsic) of the neural manifold embedded in neural state space <span class="math notranslate nohighlight">\(\mathbb{R}^N\)</span>.</p>
<p>In particular, this notebook tests several existing methods of dimension estimation on the synthetic manifolds from the module <code class="docutils literal notranslate"><span class="pre">datasets.synthetic</span></code> to evaluate their performance.</p>
<section id="Set-up-+-Imports">
<h2>Set-up + Imports<a class="headerlink" href="#Set-up-+-Imports" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">setup</span>

<span class="n">setup</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="o">%</span><span class="k">load_ext</span> jupyter_black

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">skdim</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">neurometry.datasets.synthetic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">synthetic</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">neurometry.dimension.dimension</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">plot_dimension_experiments</span><span class="p">,</span>
    <span class="n">skdim_dimension_estimation</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;GEOMSTATS_BACKEND&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pytorch&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geomstats.backend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gs</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Working directory:  /home/facosta/neurometry/neurometry
Directory added to path:  /home/facosta/neurometry
Directory added to path:  /home/facosta/neurometry/neurometry
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<script type="application/javascript" id="jupyter_black">
(function() {
    if (window.IPython === undefined) {
        return
    }
    var msg = "WARNING: it looks like you might have loaded " +
        "jupyter_black in a non-lab notebook with " +
        "`is_lab=True`. Please double check, and if " +
        "loading with `%load_ext` please review the README!"
    console.log(msg)
    alert(msg)
})()
</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:root:Using pytorch backend
INFO:numexpr.utils:Note: NumExpr detected 32 cores but &#34;NUMEXPR_MAX_THREADS&#34; not set, so enforcing safe limit of 8.
INFO:numexpr.utils:NumExpr defaulting to 8 threads.
</pre></div></div>
</div>
</section>
<section id="Show-Methods-Implemented-in-\texttt{scikit-dimension}">
<h2>Show Methods Implemented in <span class="math notranslate nohighlight">\(\texttt{scikit-dimension}\)</span><a class="headerlink" href="#Show-Methods-Implemented-in-\texttt{scikit-dimension}" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [153]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_methods</span> <span class="o">=</span> <span class="p">[</span><span class="n">method</span> <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">skdim</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">method</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">all_methods</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;CorrInt&#39;, &#39;DANCo&#39;, &#39;ESS&#39;, &#39;FisherS&#39;, &#39;KNN&#39;, &#39;MADA&#39;, &#39;MLE&#39;, &#39;MOM&#39;, &#39;MiND_ML&#39;, &#39;TLE&#39;, &#39;TwoNN&#39;, &#39;lPCA&#39;]
</pre></div></div>
</div>
</section>
<section id="Define-Parameters-for-Experiments">
<h2>Define Parameters for Experiments<a class="headerlink" href="#Define-Parameters-for-Experiments" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [150]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_points</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">num_neurons</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">max_id_dim</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">dimensions</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_id_dim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MLE&quot;</span><span class="p">,</span> <span class="s2">&quot;lPCA&quot;</span><span class="p">,</span> <span class="s2">&quot;TwoNN&quot;</span><span class="p">,</span> <span class="s2">&quot;CorrInt&quot;</span><span class="p">]</span>
<span class="n">poisson_multiplier</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_trials</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">ref_frequency</span> <span class="o">=</span> <span class="mi">50</span>
</pre></div>
</div>
</div>
</section>
<section id="Run-Experiments-for-Hyperspheres-with-\texttt{scikit-dimension}">
<h2>Run Experiments for Hyperspheres with <span class="math notranslate nohighlight">\(\texttt{scikit-dimension}\)</span><a class="headerlink" href="#Run-Experiments-for-Hyperspheres-with-\texttt{scikit-dimension}" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [151]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">manifold_type</span> <span class="o">=</span> <span class="s2">&quot;hypersphere&quot;</span>
<span class="n">id_estimates_hyperspheres</span><span class="p">,</span> <span class="n">noise_level</span> <span class="o">=</span> <span class="n">skdim_dimension_estimation</span><span class="p">(</span>
    <span class="n">methods</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="p">,</span>
    <span class="n">manifold_type</span><span class="p">,</span>
    <span class="n">num_trials</span><span class="p">,</span>
    <span class="n">num_points</span><span class="p">,</span>
    <span class="n">num_neurons</span><span class="p">,</span>
    <span class="n">poisson_multiplier</span><span class="p">,</span>
    <span class="n">ref_frequency</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plot_dimension_experiments</span><span class="p">(</span>
    <span class="n">id_estimates_hyperspheres</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">,</span> <span class="n">max_id_dim</span><span class="p">,</span> <span class="n">manifold_type</span><span class="p">,</span> <span class="n">noise_level</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_02_methods_estimate_manifold_dimension_8_0.png" src="../_images/notebooks_02_methods_estimate_manifold_dimension_8_0.png" />
</div>
</div>
</section>
<section id="Run-Experiments-for-Hypertori-with-\texttt{scikit-dimension}">
<h2>Run Experiments for Hypertori with <span class="math notranslate nohighlight">\(\texttt{scikit-dimension}\)</span><a class="headerlink" href="#Run-Experiments-for-Hypertori-with-\texttt{scikit-dimension}" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [152]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">manifold_type</span> <span class="o">=</span> <span class="s2">&quot;hypertorus&quot;</span>
<span class="n">id_estimates_hypertori</span><span class="p">,</span> <span class="n">noise_level</span> <span class="o">=</span> <span class="n">skdim_dimension_estimation</span><span class="p">(</span>
    <span class="n">methods</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="p">,</span>
    <span class="n">manifold_type</span><span class="p">,</span>
    <span class="n">num_trials</span><span class="p">,</span>
    <span class="n">num_points</span><span class="p">,</span>
    <span class="n">num_neurons</span><span class="p">,</span>
    <span class="n">poisson_multiplier</span><span class="p">,</span>
    <span class="n">ref_frequency</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plot_dimension_experiments</span><span class="p">(</span>
    <span class="n">id_estimates_hypertori</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">,</span> <span class="n">max_id_dim</span><span class="p">,</span> <span class="n">manifold_type</span><span class="p">,</span> <span class="n">noise_level</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_02_methods_estimate_manifold_dimension_10_0.png" src="../_images/notebooks_02_methods_estimate_manifold_dimension_10_0.png" />
</div>
</div>
</section>
<section id="Try-Single-Experiment">
<h2>Try Single Experiment<a class="headerlink" href="#Try-Single-Experiment" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_points</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">num_neurons</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">poisson_multiplier</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_trials</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">ref_frequency</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">manifold_type</span> <span class="o">=</span> <span class="s2">&quot;hypertorus&quot;</span>


<span class="n">point_generator</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">synthetic</span><span class="p">,</span> <span class="n">manifold_type</span><span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">point_generator</span><span class="p">(</span><span class="n">intrinsic_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_points</span><span class="o">=</span><span class="n">num_points</span><span class="p">)</span>
<span class="n">neural_manifold</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">synthetic</span><span class="o">.</span><span class="n">synthetic_neural_manifold</span><span class="p">(</span>
    <span class="n">points</span><span class="p">,</span>
    <span class="n">num_neurons</span><span class="p">,</span>
    <span class="s2">&quot;sigmoid&quot;</span><span class="p">,</span>
    <span class="n">poisson_multiplier</span><span class="p">,</span>
    <span class="n">ref_frequency</span><span class="p">,</span>
    <span class="n">scales</span><span class="o">=</span><span class="n">gs</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_neurons</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neural_manifold</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
torch.Size([2000, 40])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [217]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">method_name</span> <span class="o">=</span> <span class="s2">&quot;KNN&quot;</span>

<span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">skdim</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">method_name</span><span class="p">)()</span>

<span class="n">estimates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_trials</span><span class="p">)</span>

<span class="k">for</span> <span class="n">trial_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_trials</span><span class="p">):</span>
    <span class="n">method</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">neural_manifold</span><span class="p">)</span>
    <span class="n">estimates</span><span class="p">[</span><span class="n">trial_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">dimension_</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">estimates</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 2.  2.  3.  5.  2.  2.  4.  2.  2.  2.  2. 17.  4.  2. 40.  2.  2.  2.
  5.  3.  2.  2.  2.  3. 40.  2.  2. 11. 10.  5. 40.  2.  4.  4. 38.  3.
  3.  3.  1.  3.  2. 40.  2.  3.  2.  7.  2.  9.  2.  2.]
</pre></div></div>
</div>
<p>try: find median/mode of KNN algorithm</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [218]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">estimates</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [218]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tensor(2.)
</pre></div></div>
</div>
<p>try: first PCA data down to minimal embedding dim, then nonlinear dim est</p>
<section id="PLS-approach">
<h3>PLS approach<a class="headerlink" href="#PLS-approach" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.cross_decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PLSRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.multioutput</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiOutputRegressor</span>


<span class="k">def</span><span class="w"> </span><span class="nf">evaluate_pls_with_different_K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">K_values</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate PLS Regression followed by Multi-Output Regression for different numbers of components (K).</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - X: Neural activity data (predictors)</span>
<span class="sd">    - Y: Continuous 2D outcomes</span>
<span class="sd">    - K_values: A list of integers representing different numbers of PLS components to evaluate</span>

<span class="sd">    Returns:</span>
<span class="sd">    - A list of R^2 scores corresponding to each K-value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r2_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">projected_X</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Split data into training and test sets</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="n">K_values</span><span class="p">:</span>
        <span class="c1"># Initialize and fit PLS Regression</span>
        <span class="n">pls</span> <span class="o">=</span> <span class="n">PLSRegression</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>
        <span class="n">pls</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>

        <span class="c1"># Project both training and test data using the PLS model</span>
        <span class="n">X_train_pls</span> <span class="o">=</span> <span class="n">pls</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">X_test_pls</span> <span class="o">=</span> <span class="n">pls</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">projected_X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pls</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">X_test_pls</span><span class="p">))</span>

        <span class="c1"># Fit the Multi-Output Regression model on the reduced data</span>
        <span class="n">multi_output_reg</span> <span class="o">=</span> <span class="n">MultiOutputRegressor</span><span class="p">(</span><span class="n">LinearRegression</span><span class="p">())</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">X_train_pls</span><span class="p">,</span> <span class="n">Y_train</span>
        <span class="p">)</span>

        <span class="c1"># Predict and evaluate using R^2 score</span>
        <span class="n">Y_pred</span> <span class="o">=</span> <span class="n">multi_output_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_pls</span><span class="p">)</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span>
            <span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred</span><span class="p">,</span> <span class="n">multioutput</span><span class="o">=</span><span class="s2">&quot;uniform_average&quot;</span>
        <span class="p">)</span>  <span class="c1"># Average R^2 score across all outputs</span>
        <span class="n">r2_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">r2_scores</span><span class="p">,</span> <span class="n">projected_X</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>


<span class="k">def</span><span class="w"> </span><span class="nf">evaluate_PCA_with_different_K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">K_values</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate PCA for different numbers of components (K).</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - X: Data to perform PCA on</span>
<span class="sd">    - K_values: A list of integers representing different numbers of PCA components to evaluate</span>

<span class="sd">    Returns:</span>
<span class="sd">    - A list of R^2 scores corresponding to each K-value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r2_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">projected_X</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Split data into training and test sets</span>

    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="n">K_values</span><span class="p">:</span>
        <span class="c1"># Initialize and fit PCA</span>
        <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>
        <span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

        <span class="c1"># Project both training and test data using the PCA model</span>
        <span class="n">X_train_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">X_test_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">projected_X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">X_test_pca</span><span class="p">))</span>

        <span class="c1"># Fit the Multi-Output Regression model on the reduced data</span>
        <span class="n">multi_output_reg</span> <span class="o">=</span> <span class="n">MultiOutputRegressor</span><span class="p">(</span><span class="n">LinearRegression</span><span class="p">())</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">X_train_pca</span><span class="p">,</span> <span class="n">Y_train</span>
        <span class="p">)</span>

        <span class="c1"># Predict and evaluate using R^2 score</span>
        <span class="n">Y_pred</span> <span class="o">=</span> <span class="n">multi_output_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_pca</span><span class="p">)</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span>
            <span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred</span><span class="p">,</span> <span class="n">multioutput</span><span class="o">=</span><span class="s2">&quot;uniform_average&quot;</span>
        <span class="p">)</span>  <span class="c1"># Average R^2 score across all outputs</span>
        <span class="n">r2_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">r2_scores</span><span class="p">,</span> <span class="n">projected_X</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">KFold</span>


<span class="k">def</span><span class="w"> </span><span class="nf">evaluate_PCA_with_different_K_cv</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">K_values</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate PCA for different numbers of components (K) using cross-validation.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - X: Data to perform PCA on</span>
<span class="sd">    - Y: Continuous 2D outcomes</span>
<span class="sd">    - K_values: A list of integers representing different numbers of PCA components to evaluate</span>
<span class="sd">    - n_splits: Number of folds in K-Fold cross-validation</span>

<span class="sd">    Returns:</span>
<span class="sd">    - A dictionary of R^2 scores for each K-value, each containing a list of scores for each fold</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cv_scores</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">K</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="n">K_values</span>
    <span class="p">}</span>  <span class="c1"># Initialize dictionary to store scores for each K</span>

    <span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">n_splits</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="n">K_values</span><span class="p">:</span>
        <span class="c1"># Loop through each fold defined by KFold</span>
        <span class="k">for</span> <span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span> <span class="ow">in</span> <span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
            <span class="c1"># Split data into training and test sets for this fold</span>
            <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>
            <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>

            <span class="c1"># Initialize and fit PCA</span>
            <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>
            <span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

            <span class="c1"># Project both training and test data using the PCA model</span>
            <span class="n">X_train_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
            <span class="n">X_test_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

            <span class="c1"># Fit the Multi-Output Regression model on the reduced data</span>
            <span class="n">multi_output_reg</span> <span class="o">=</span> <span class="n">MultiOutputRegressor</span><span class="p">(</span><span class="n">LinearRegression</span><span class="p">())</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
                <span class="n">X_train_pca</span><span class="p">,</span> <span class="n">Y_train</span>
            <span class="p">)</span>

            <span class="c1"># Predict and evaluate using R^2 score</span>
            <span class="n">Y_pred</span> <span class="o">=</span> <span class="n">multi_output_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_pca</span><span class="p">)</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred</span><span class="p">,</span> <span class="n">multioutput</span><span class="o">=</span><span class="s2">&quot;uniform_average&quot;</span><span class="p">)</span>
            <span class="n">cv_scores</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cv_scores</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>


<span class="k">def</span><span class="w"> </span><span class="nf">evaluate_pls_with_different_K_cv</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">K_values</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate PLS Regression followed by Multi-Output Regression for different numbers of components (K)</span>
<span class="sd">    using cross-validation.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - X: Neural activity data (predictors)</span>
<span class="sd">    - Y: Continuous 2D outcomes</span>
<span class="sd">    - K_values: A list of integers representing different numbers of PLS components to evaluate</span>
<span class="sd">    - n_splits: Number of folds in K-Fold cross-validation</span>

<span class="sd">    Returns:</span>
<span class="sd">    - A dictionary of R^2 scores for each K-value, each containing a list of scores for each fold</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cv_scores</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">K</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="n">K_values</span>
    <span class="p">}</span>  <span class="c1"># Initialize dictionary to store scores for each K</span>

    <span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">n_splits</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="n">K_values</span><span class="p">:</span>
        <span class="c1"># Loop through each fold defined by KFold</span>
        <span class="k">for</span> <span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span> <span class="ow">in</span> <span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
            <span class="c1"># Split data into training and test sets for this fold</span>
            <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>
            <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>

            <span class="c1"># Initialize and fit PLS Regression</span>
            <span class="n">pls</span> <span class="o">=</span> <span class="n">PLSRegression</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>
            <span class="n">pls</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>

            <span class="c1"># Project both training and test data using the PLS model</span>
            <span class="n">X_train_pls</span> <span class="o">=</span> <span class="n">pls</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
            <span class="n">X_test_pls</span> <span class="o">=</span> <span class="n">pls</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

            <span class="c1"># Fit the Multi-Output Regression model on the reduced data</span>
            <span class="n">multi_output_reg</span> <span class="o">=</span> <span class="n">MultiOutputRegressor</span><span class="p">(</span><span class="n">LinearRegression</span><span class="p">())</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
                <span class="n">X_train_pls</span><span class="p">,</span> <span class="n">Y_train</span>
            <span class="p">)</span>

            <span class="c1"># Predict and evaluate using R^2 score</span>
            <span class="n">Y_pred</span> <span class="o">=</span> <span class="n">multi_output_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_pls</span><span class="p">)</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span>
                <span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred</span><span class="p">,</span> <span class="n">multioutput</span><span class="o">=</span><span class="s2">&quot;uniform_average&quot;</span>
            <span class="p">)</span>  <span class="c1"># Average R^2 score across all outputs</span>
            <span class="n">cv_scores</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cv_scores</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [90]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">neurometry.datasets.synthetic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">synthetic</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">task_points</span> <span class="o">=</span> <span class="n">synthetic</span><span class="o">.</span><span class="n">hypertorus</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">noisy_points</span><span class="p">,</span> <span class="n">manifold_points</span> <span class="o">=</span> <span class="n">synthetic</span><span class="o">.</span><span class="n">synthetic_neural_manifold</span><span class="p">(</span>
    <span class="n">points</span><span class="o">=</span><span class="n">task_points</span><span class="p">,</span>
    <span class="n">encoding_dim</span><span class="o">=</span><span class="n">N</span><span class="p">,</span>
    <span class="n">nonlinearity</span><span class="o">=</span><span class="s2">&quot;sigmoid&quot;</span><span class="p">,</span>
    <span class="n">poisson_multiplier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">scales</span><span class="o">=</span><span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">N</span><span class="p">)),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
noise level: 7.07%
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [91]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>


<span class="k">def</span><span class="w"> </span><span class="nf">add_noise_dimensions</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n_dims</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a column of random noise to the input data.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - data: A numpy array of shape (num_points, dim), where `num_points` is the number of data points</span>
<span class="sd">            and `dim` is the dimensionality of each data point.</span>
<span class="sd">    - noise_scale: The standard deviation of the Gaussian noise to be added. Default is 1.0.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - A numpy array of shape (num_points, dim+1), where the last column is filled with random noise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_points</span><span class="p">,</span> <span class="n">dim</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
        <span class="n">loc</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">num_points</span><span class="p">,</span> <span class="n">n_dims</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># noise = np.random.uniform(</span>
    <span class="c1">#     low=torch.min(data), high=torch.max(data), size=(num_points, n_dims)</span>
    <span class="c1"># )</span>
    <span class="n">noisy_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="n">noise</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">noisy_data</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [92]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">add_noise_dimensions</span><span class="p">(</span><span class="n">noisy_points</span><span class="p">,</span> <span class="n">n_dims</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">task_points</span>

<span class="nb">print</span><span class="p">(</span><span class="n">noisy_points</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
torch.Size([500, 20])
(500, 40)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_02_methods_estimate_manifold_dimension_25_1.png" src="../_images/notebooks_02_methods_estimate_manifold_dimension_25_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [93]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>

<span class="n">pls_r2_scores</span><span class="p">,</span> <span class="n">pls_transformed_X</span> <span class="o">=</span> <span class="n">evaluate_pls_with_different_K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">K_values</span><span class="p">)</span>

<span class="n">pca_r2_scores</span><span class="p">,</span> <span class="n">pca_transformed_X</span> <span class="o">=</span> <span class="n">evaluate_PCA_with_different_K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">K_values</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">K_values</span><span class="p">,</span> <span class="n">pls_r2_scores</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;PLS $R^2$ Score&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">K_values</span><span class="p">,</span> <span class="n">pca_r2_scores</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;PCA $R^2$ Score&quot;</span><span class="p">)</span>

<span class="c1"># pls_cv_scores = evaluate_pls_with_different_K_cv(X, Y, K_values, n_splits=5)</span>

<span class="c1"># pca_cv_scores = evaluate_PCA_with_different_K_cv(X, Y, K_values, n_splits=5)</span>


<span class="c1"># plt.errorbar(</span>
<span class="c1">#     K_values,</span>
<span class="c1">#     np.mean(list(pls_cv_scores.values()), axis=1),</span>
<span class="c1">#     yerr=np.std(list(pls_cv_scores.values()), axis=1),</span>
<span class="c1">#     fmt=&quot;-o&quot;,</span>
<span class="c1">#     label=&quot;PLS R^2 Score&quot;,</span>
<span class="c1"># )</span>

<span class="c1"># plt.errorbar(</span>
<span class="c1">#     K_values,</span>
<span class="c1">#     np.mean(list(pca_cv_scores.values()), axis=1),</span>
<span class="c1">#     yerr=np.std(list(pca_cv_scores.values()), axis=1),</span>
<span class="c1">#     fmt=&quot;-o&quot;,</span>
<span class="c1">#     label=&quot;PCA R^2 Score&quot;,</span>
<span class="c1"># )</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">K_values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of PLS/PCA Components (K)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$R^2$ Score of Position Prediction&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Position Prediction Performance vs. Number of Components&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center left&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_02_methods_estimate_manifold_dimension_26_0.png" src="../_images/notebooks_02_methods_estimate_manifold_dimension_26_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [94]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">gtda.homology</span><span class="w"> </span><span class="kn">import</span> <span class="n">VietorisRipsPersistence</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gtda.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_diagram</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [95]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_components</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">X_pls</span> <span class="o">=</span> <span class="n">pls_transformed_X</span><span class="p">[</span><span class="n">n_components</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">X_pca</span> <span class="o">=</span> <span class="n">pca_transformed_X</span><span class="p">[</span><span class="n">n_components</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>


<span class="n">vr_pers</span> <span class="o">=</span> <span class="n">VietorisRipsPersistence</span><span class="p">(</span><span class="n">homology_dimensions</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">diagrams</span> <span class="o">=</span> <span class="n">vr_pers</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">([</span><span class="n">X_pls</span><span class="p">,</span> <span class="n">X_pca</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [96]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pls_pers_plot</span> <span class="o">=</span> <span class="n">plot_diagram</span><span class="p">(</span><span class="n">diagrams</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">pls_pers_plot</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;V-R Persist. Diag., PLS-projected data (dim=4)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>                            <div id="44b30792-20df-4eb4-a7e8-cd56565cc9da" class="plotly-graph-div" style="height:500px; width:500px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("44b30792-20df-4eb4-a7e8-cd56565cc9da")) {                    Plotly.newPlot(                        "44b30792-20df-4eb4-a7e8-cd56565cc9da",                        [{"hoverinfo":"none","line":{"color":"black","dash":"dash","width":1},"mode":"lines","showlegend":false,"x":[-6.00622314453125,306.31738037109375],"y":[-6.00622314453125,306.31738037109375],"type":"scatter"},{"hoverinfo":"text","hovertext":["(0.0, 23.380691528320312)","(0.0, 24.073719024658203)","(0.0, 24.291982650756836)","(0.0, 26.68541717529297)","(0.0, 27.63804054260254)","(0.0, 31.665224075317383)","(0.0, 31.782718658447266)","(0.0, 32.09221267700195)","(0.0, 32.32810974121094)","(0.0, 35.99968338012695)","(0.0, 37.49104309082031)","(0.0, 37.52478790283203)","(0.0, 38.20622634887695)","(0.0, 42.12957000732422)","(0.0, 42.443729400634766)","(0.0, 42.69802474975586)","(0.0, 44.12461471557617)","(0.0, 44.454139709472656)","(0.0, 44.46125030517578)","(0.0, 44.93540954589844)","(0.0, 46.14592742919922)","(0.0, 47.428443908691406)","(0.0, 47.945457458496094)","(0.0, 47.951507568359375)","(0.0, 48.00108337402344)","(0.0, 48.296146392822266)","(0.0, 49.155494689941406)","(0.0, 50.60812759399414)","(0.0, 54.36311721801758)","(0.0, 56.41363525390625)","(0.0, 58.27460861206055)","(0.0, 58.50710678100586)","(0.0, 58.62872314453125)","(0.0, 58.898860931396484)","(0.0, 59.752525329589844)","(0.0, 59.789886474609375)","(0.0, 60.06039810180664)","(0.0, 60.591819763183594)","(0.0, 60.93049240112305)","(0.0, 61.26927185058594)","(0.0, 62.30350112915039)","(0.0, 63.16791534423828)","(0.0, 63.25541305541992)","(0.0, 63.749359130859375)","(0.0, 64.40113830566406)","(0.0, 64.57633209228516)","(0.0, 64.74266052246094)","(0.0, 66.78865051269531)","(0.0, 67.3796615600586)","(0.0, 67.97509765625)","(0.0, 67.9856185913086)","(0.0, 68.01454162597656)","(0.0, 68.92190551757812)","(0.0, 69.04132080078125)","(0.0, 70.86408996582031)","(0.0, 71.77470397949219)","(0.0, 72.81822204589844)","(0.0, 72.88013458251953)","(0.0, 73.46284484863281)","(0.0, 73.62821197509766)","(0.0, 75.29656982421875)","(0.0, 75.52407836914062)","(0.0, 77.7158432006836)","(0.0, 80.70024871826172)","(0.0, 81.36549377441406)","(0.0, 81.66609954833984)","(0.0, 81.7615737915039)","(0.0, 82.64934539794922)","(0.0, 83.21451568603516)","(0.0, 83.52913665771484)","(0.0, 84.13936614990234)","(0.0, 84.69918060302734)","(0.0, 84.95130920410156)","(0.0, 87.47559356689453)","(0.0, 89.51921844482422)","(0.0, 90.27024841308594)","(0.0, 90.67440795898438)","(0.0, 91.96076965332031)","(0.0, 92.9847183227539)","(0.0, 94.36587524414062)","(0.0, 94.94579315185547)","(0.0, 95.86775207519531)","(0.0, 96.11665344238281)","(0.0, 97.31047821044922)","(0.0, 98.15999603271484)","(0.0, 100.8243408203125)","(0.0, 103.253662109375)","(0.0, 103.80691528320312)","(0.0, 104.4938735961914)","(0.0, 107.5279541015625)","(0.0, 107.59000396728516)","(0.0, 107.99513244628906)","(0.0, 110.51080322265625)","(0.0, 111.2080078125)","(0.0, 111.96623229980469)","(0.0, 112.82003784179688)","(0.0, 115.3654556274414)","(0.0, 125.03176879882812)","(0.0, 137.57203674316406)"],"mode":"markers","name":"H0","x":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],"y":[23.380691528320312,24.073719024658203,24.291982650756836,26.68541717529297,27.63804054260254,31.665224075317383,31.782718658447266,32.09221267700195,32.32810974121094,35.99968338012695,37.49104309082031,37.52478790283203,38.20622634887695,42.12957000732422,42.443729400634766,42.69802474975586,44.12461471557617,44.454139709472656,44.46125030517578,44.93540954589844,46.14592742919922,47.428443908691406,47.945457458496094,47.951507568359375,48.00108337402344,48.296146392822266,49.155494689941406,50.60812759399414,54.36311721801758,56.41363525390625,58.27460861206055,58.50710678100586,58.62872314453125,58.898860931396484,59.752525329589844,59.789886474609375,60.06039810180664,60.591819763183594,60.93049240112305,61.26927185058594,62.30350112915039,63.16791534423828,63.25541305541992,63.749359130859375,64.40113830566406,64.57633209228516,64.74266052246094,66.78865051269531,67.3796615600586,67.97509765625,67.9856185913086,68.01454162597656,68.92190551757812,69.04132080078125,70.86408996582031,71.77470397949219,72.81822204589844,72.88013458251953,73.46284484863281,73.62821197509766,75.29656982421875,75.52407836914062,77.7158432006836,80.70024871826172,81.36549377441406,81.66609954833984,81.7615737915039,82.64934539794922,83.21451568603516,83.52913665771484,84.13936614990234,84.69918060302734,84.95130920410156,87.47559356689453,89.51921844482422,90.27024841308594,90.67440795898438,91.96076965332031,92.9847183227539,94.36587524414062,94.94579315185547,95.86775207519531,96.11665344238281,97.31047821044922,98.15999603271484,100.8243408203125,103.253662109375,103.80691528320312,104.4938735961914,107.5279541015625,107.59000396728516,107.99513244628906,110.51080322265625,111.2080078125,111.96623229980469,112.82003784179688,115.3654556274414,125.03176879882812,137.57203674316406],"type":"scatter"},{"hoverinfo":"text","hovertext":["(216.71620178222656, 232.4755096435547)","(179.07003784179688, 230.04583740234375)","(177.8965301513672, 195.97488403320312)","(175.811767578125, 203.37269592285156)","(172.20538330078125, 208.22909545898438)","(169.8529510498047, 249.60653686523438)","(168.0586395263672, 176.8628387451172)","(146.25946044921875, 164.83798217773438)","(140.36212158203125, 246.33348083496094)","(135.92710876464844, 239.01068115234375)","(135.46697998046875, 191.2174072265625)","(129.27296447753906, 133.0552978515625)","(129.20230102539062, 162.64010620117188)","(125.16154479980469, 232.53408813476562)","(121.91678619384766, 122.82532501220703)","(121.68036651611328, 122.76625061035156)","(120.73667907714844, 129.31893920898438)","(116.50322723388672, 140.08753967285156)","(115.32949829101562, 120.1369400024414)","(111.11360931396484, 134.49026489257812)","(104.09242248535156, 120.31160736083984)","(100.30183410644531, 122.1935043334961)","(88.48522186279297, 88.8235855102539)","(87.42359924316406, 125.90760803222656)","(84.7657699584961, 89.50222778320312)","(79.8254165649414, 91.09886932373047)"],"mode":"markers","name":"H1","x":[216.71620178222656,179.07003784179688,177.8965301513672,175.811767578125,172.20538330078125,169.8529510498047,168.0586395263672,146.25946044921875,140.36212158203125,135.92710876464844,135.46697998046875,129.27296447753906,129.20230102539062,125.16154479980469,121.91678619384766,121.68036651611328,120.73667907714844,116.50322723388672,115.32949829101562,111.11360931396484,104.09242248535156,100.30183410644531,88.48522186279297,87.42359924316406,84.7657699584961,79.8254165649414],"y":[232.4755096435547,230.04583740234375,195.97488403320312,203.37269592285156,208.22909545898438,249.60653686523438,176.8628387451172,164.83798217773438,246.33348083496094,239.01068115234375,191.2174072265625,133.0552978515625,162.64010620117188,232.53408813476562,122.82532501220703,122.76625061035156,129.31893920898438,140.08753967285156,120.1369400024414,134.49026489257812,120.31160736083984,122.1935043334961,88.8235855102539,125.90760803222656,89.50222778320312,91.09886932373047],"type":"scatter"},{"hoverinfo":"text","hovertext":["(288.06842041015625, 292.4917907714844)","(285.846923828125, 288.7779541015625)","(282.358154296875, 293.1643981933594)","(280.4047546386719, 300.130615234375)","(277.6382751464844, 278.2208557128906)","(268.6706848144531, 300.3111572265625)","(265.7160339355469, 277.0776062011719)","(263.04486083984375, 283.4955749511719)","(248.92413330078125, 294.9757080078125)"],"mode":"markers","name":"H2","x":[288.06842041015625,285.846923828125,282.358154296875,280.4047546386719,277.6382751464844,268.6706848144531,265.7160339355469,263.04486083984375,248.92413330078125],"y":[292.4917907714844,288.7779541015625,293.1643981933594,300.130615234375,278.2208557128906,300.3111572265625,277.0776062011719,283.4955749511719,294.9757080078125],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"title":{"text":"Birth"},"side":"bottom","type":"linear","range":[-6.00622314453125,306.31738037109375],"autorange":false,"ticks":"outside","showline":true,"zeroline":true,"linewidth":1,"linecolor":"black","mirror":false,"showexponent":"all","exponentformat":"e"},"yaxis":{"title":{"text":"Death"},"side":"left","type":"linear","range":[-6.00622314453125,306.31738037109375],"autorange":false,"scaleanchor":"x","scaleratio":1,"ticks":"outside","showline":true,"zeroline":true,"linewidth":1,"linecolor":"black","mirror":false,"showexponent":"all","exponentformat":"e"},"width":500,"height":500,"plot_bgcolor":"white","title":{"text":"V-R Persist. Diag., PLS-projected data (dim=4)"}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('44b30792-20df-4eb4-a7e8-cd56565cc9da');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [97]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca_pers_plot</span> <span class="o">=</span> <span class="n">plot_diagram</span><span class="p">(</span><span class="n">diagrams</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">pca_pers_plot</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;V-R Persist. Diag., PCA-projected data (dim=</span><span class="si">{</span><span class="n">n_components</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>                            <div id="e4268aba-4206-4fc3-b7ee-4def3af806b3" class="plotly-graph-div" style="height:500px; width:500px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e4268aba-4206-4fc3-b7ee-4def3af806b3")) {                    Plotly.newPlot(                        "e4268aba-4206-4fc3-b7ee-4def3af806b3",                        [{"hoverinfo":"none","line":{"color":"black","dash":"dash","width":1},"mode":"lines","showlegend":false,"x":[-4.942767028808594,252.08111846923828],"y":[-4.942767028808594,252.08111846923828],"type":"scatter"},{"hoverinfo":"text","hovertext":["(0.0, 26.046493530273438)","(0.0, 30.277633666992188)","(0.0, 32.51106643676758)","(0.0, 34.359249114990234)","(0.0, 38.41322326660156)","(0.0, 45.93193817138672)","(0.0, 48.02346420288086)","(0.0, 52.94376754760742)","(0.0, 55.25425720214844)","(0.0, 59.38753128051758)","(0.0, 60.6656494140625)","(0.0, 62.37641143798828)","(0.0, 62.619224548339844)","(0.0, 62.83320999145508)","(0.0, 63.47865676879883)","(0.0, 64.62799072265625)","(0.0, 64.92308044433594)","(0.0, 66.18289947509766)","(0.0, 67.57231140136719)","(0.0, 68.86061096191406)","(0.0, 69.43609619140625)","(0.0, 70.4439926147461)","(0.0, 71.89225769042969)","(0.0, 74.09868621826172)","(0.0, 74.7098388671875)","(0.0, 75.18416595458984)","(0.0, 76.94420623779297)","(0.0, 78.48918914794922)","(0.0, 78.97871398925781)","(0.0, 79.22000122070312)","(0.0, 79.89788818359375)","(0.0, 79.96366119384766)","(0.0, 80.55170440673828)","(0.0, 80.7467269897461)","(0.0, 81.06961822509766)","(0.0, 82.9924087524414)","(0.0, 83.20390319824219)","(0.0, 84.1416015625)","(0.0, 84.4865951538086)","(0.0, 84.54139709472656)","(0.0, 86.11109924316406)","(0.0, 86.12974548339844)","(0.0, 86.42227935791016)","(0.0, 87.17227935791016)","(0.0, 87.27684020996094)","(0.0, 88.4053955078125)","(0.0, 94.07527160644531)","(0.0, 94.1418228149414)","(0.0, 94.35546875)","(0.0, 95.5042953491211)","(0.0, 95.59220123291016)","(0.0, 96.07450103759766)","(0.0, 96.23882293701172)","(0.0, 96.95524597167969)","(0.0, 97.59078216552734)","(0.0, 97.68098449707031)","(0.0, 98.78862762451172)","(0.0, 99.08512878417969)","(0.0, 99.09274291992188)","(0.0, 99.31748962402344)","(0.0, 102.16815948486328)","(0.0, 102.6988296508789)","(0.0, 102.96576690673828)","(0.0, 103.76239013671875)","(0.0, 104.10298919677734)","(0.0, 105.73078918457031)","(0.0, 106.61711883544922)","(0.0, 109.56263732910156)","(0.0, 109.81242370605469)","(0.0, 110.74275207519531)","(0.0, 111.37344360351562)","(0.0, 111.75474548339844)","(0.0, 112.16831970214844)","(0.0, 112.37152862548828)","(0.0, 112.97587585449219)","(0.0, 114.23612213134766)","(0.0, 114.53360748291016)","(0.0, 116.13905334472656)","(0.0, 117.12051391601562)","(0.0, 117.26930236816406)","(0.0, 118.34365844726562)","(0.0, 118.74602508544922)","(0.0, 120.59113311767578)","(0.0, 121.13451385498047)","(0.0, 122.54937744140625)","(0.0, 122.8846664428711)","(0.0, 124.63661193847656)","(0.0, 127.1757583618164)","(0.0, 128.97848510742188)","(0.0, 129.42674255371094)","(0.0, 130.2799835205078)","(0.0, 130.4882049560547)","(0.0, 136.34056091308594)","(0.0, 137.47390747070312)","(0.0, 138.79356384277344)","(0.0, 143.94361877441406)","(0.0, 153.24423217773438)","(0.0, 157.1208038330078)","(0.0, 167.989501953125)"],"mode":"markers","name":"H0","x":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],"y":[26.046493530273438,30.277633666992188,32.51106643676758,34.359249114990234,38.41322326660156,45.93193817138672,48.02346420288086,52.94376754760742,55.25425720214844,59.38753128051758,60.6656494140625,62.37641143798828,62.619224548339844,62.83320999145508,63.47865676879883,64.62799072265625,64.92308044433594,66.18289947509766,67.57231140136719,68.86061096191406,69.43609619140625,70.4439926147461,71.89225769042969,74.09868621826172,74.7098388671875,75.18416595458984,76.94420623779297,78.48918914794922,78.97871398925781,79.22000122070312,79.89788818359375,79.96366119384766,80.55170440673828,80.7467269897461,81.06961822509766,82.9924087524414,83.20390319824219,84.1416015625,84.4865951538086,84.54139709472656,86.11109924316406,86.12974548339844,86.42227935791016,87.17227935791016,87.27684020996094,88.4053955078125,94.07527160644531,94.1418228149414,94.35546875,95.5042953491211,95.59220123291016,96.07450103759766,96.23882293701172,96.95524597167969,97.59078216552734,97.68098449707031,98.78862762451172,99.08512878417969,99.09274291992188,99.31748962402344,102.16815948486328,102.6988296508789,102.96576690673828,103.76239013671875,104.10298919677734,105.73078918457031,106.61711883544922,109.56263732910156,109.81242370605469,110.74275207519531,111.37344360351562,111.75474548339844,112.16831970214844,112.37152862548828,112.97587585449219,114.23612213134766,114.53360748291016,116.13905334472656,117.12051391601562,117.26930236816406,118.34365844726562,118.74602508544922,120.59113311767578,121.13451385498047,122.54937744140625,122.8846664428711,124.63661193847656,127.1757583618164,128.97848510742188,129.42674255371094,130.2799835205078,130.4882049560547,136.34056091308594,137.47390747070312,138.79356384277344,143.94361877441406,153.24423217773438,157.1208038330078,167.989501953125],"type":"scatter"},{"hoverinfo":"text","hovertext":["(212.16651916503906, 231.40478515625)","(197.5873565673828, 214.59400939941406)","(186.8058624267578, 189.89862060546875)","(181.14569091796875, 187.49612426757812)","(164.30364990234375, 173.70013427734375)","(164.23675537109375, 183.0028839111328)","(162.38079833984375, 180.35177612304688)","(155.1094207763672, 193.5175323486328)","(154.68797302246094, 210.58070373535156)","(149.79762268066406, 156.20523071289062)","(148.42137145996094, 152.84243774414062)","(148.0737762451172, 175.66685485839844)","(146.08450317382812, 185.29049682617188)","(141.4274444580078, 151.85621643066406)","(140.72103881835938, 147.6915283203125)","(140.46255493164062, 159.7113800048828)","(140.4362335205078, 153.74188232421875)","(139.20567321777344, 178.44229125976562)","(137.44798278808594, 147.6915283203125)","(137.16477966308594, 143.63311767578125)","(135.97650146484375, 151.77932739257812)","(134.38690185546875, 141.835693359375)","(134.2109375, 150.1522216796875)","(132.6506805419922, 142.3591766357422)","(131.87564086914062, 171.4388885498047)","(125.0521240234375, 142.9154052734375)","(124.77920532226562, 128.13153076171875)","(124.6473617553711, 145.91371154785156)","(123.7988510131836, 161.80250549316406)","(122.71536254882812, 156.05084228515625)","(122.20365142822266, 156.37515258789062)","(106.9169921875, 109.24552154541016)","(82.61305236816406, 91.42029571533203)","(80.60365295410156, 93.37496948242188)"],"mode":"markers","name":"H1","x":[212.16651916503906,197.5873565673828,186.8058624267578,181.14569091796875,164.30364990234375,164.23675537109375,162.38079833984375,155.1094207763672,154.68797302246094,149.79762268066406,148.42137145996094,148.0737762451172,146.08450317382812,141.4274444580078,140.72103881835938,140.46255493164062,140.4362335205078,139.20567321777344,137.44798278808594,137.16477966308594,135.97650146484375,134.38690185546875,134.2109375,132.6506805419922,131.87564086914062,125.0521240234375,124.77920532226562,124.6473617553711,123.7988510131836,122.71536254882812,122.20365142822266,106.9169921875,82.61305236816406,80.60365295410156],"y":[231.40478515625,214.59400939941406,189.89862060546875,187.49612426757812,173.70013427734375,183.0028839111328,180.35177612304688,193.5175323486328,210.58070373535156,156.20523071289062,152.84243774414062,175.66685485839844,185.29049682617188,151.85621643066406,147.6915283203125,159.7113800048828,153.74188232421875,178.44229125976562,147.6915283203125,143.63311767578125,151.77932739257812,141.835693359375,150.1522216796875,142.3591766357422,171.4388885498047,142.9154052734375,128.13153076171875,145.91371154785156,161.80250549316406,156.05084228515625,156.37515258789062,109.24552154541016,91.42029571533203,93.37496948242188],"type":"scatter"},{"hoverinfo":"text","hovertext":["(241.89227294921875, 247.1383514404297)","(214.11837768554688, 242.71762084960938)","(208.73275756835938, 214.66488647460938)","(193.54061889648438, 196.02735900878906)","(190.93690490722656, 197.4855499267578)","(173.5049591064453, 173.90774536132812)","(169.2471466064453, 191.07614135742188)"],"mode":"markers","name":"H2","x":[241.89227294921875,214.11837768554688,208.73275756835938,193.54061889648438,190.93690490722656,173.5049591064453,169.2471466064453],"y":[247.1383514404297,242.71762084960938,214.66488647460938,196.02735900878906,197.4855499267578,173.90774536132812,191.07614135742188],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"title":{"text":"Birth"},"side":"bottom","type":"linear","range":[-4.942767028808594,252.08111846923828],"autorange":false,"ticks":"outside","showline":true,"zeroline":true,"linewidth":1,"linecolor":"black","mirror":false,"showexponent":"all","exponentformat":"e"},"yaxis":{"title":{"text":"Death"},"side":"left","type":"linear","range":[-4.942767028808594,252.08111846923828],"autorange":false,"scaleanchor":"x","scaleratio":1,"ticks":"outside","showline":true,"zeroline":true,"linewidth":1,"linecolor":"black","mirror":false,"showexponent":"all","exponentformat":"e"},"width":500,"height":500,"plot_bgcolor":"white","title":{"text":"V-R Persist. Diag., PCA-projected data (dim=4)"}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('e4268aba-4206-4fc3-b7ee-4def3af806b3');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [77]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">gtda.diagrams</span><span class="w"> </span><span class="kn">import</span> <span class="n">BettiCurve</span><span class="p">,</span> <span class="n">Scaler</span>


<span class="k">def</span><span class="w"> </span><span class="nf">max_function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="n">scaler</span> <span class="o">=</span> <span class="n">Scaler</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="n">max_function</span><span class="p">)</span>

<span class="n">diagrams_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">diagrams</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [98]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">betticurves</span> <span class="o">=</span> <span class="n">BettiCurve</span><span class="p">(</span><span class="n">n_bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">betti_curves</span> <span class="o">=</span> <span class="n">betticurves</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">diagrams</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [99]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">betticurves</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">betti_curves</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>                            <div id="4bdf4ea5-28ba-45c2-924b-987a73652217" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("4bdf4ea5-28ba-45c2-924b-987a73652217")) {                    Plotly.newPlot(                        "4bdf4ea5-28ba-45c2-924b-987a73652217",                        [{"mode":"lines","name":"H0","showlegend":true,"x":[0.0,3.428357182716837,6.856714365433674,10.28507154815051,13.713428730867347,17.141785913584183,20.57014309630102,23.998500279017858,27.426857461734695,30.855214644451532,34.283571827168366,37.7119290098852,41.14028619260204,44.56864337531888,47.997000558035715,51.42535774075255,54.85371492346939,58.28207210618623,61.710429288903065,65.1387864716199,68.56714365433673,71.99550083705357,75.4238580197704,78.85221520248724,82.28057238520408,85.70892956792092,89.13728675063776,92.5656439333546,95.99400111607143,99.42235829878827,102.8507154815051,106.27907266422194,109.70742984693878,113.13578702965562,116.56414421237245,119.99250139508929,123.42085857780613,126.84921576052297,130.2775729432398,133.70593012595663,137.13428730867346,140.5626444913903,143.99100167410714,147.41935885682398,150.8477160395408,154.27607322225765,157.7044304049745,161.13278758769133,164.56114477040816,167.989501953125],"y":[99,99,99,99,99,99,99,98,95,94,90,87,86,80,75,71,70,68,59,52,47,43,38,36,32,26,25,21,17,14,13,10,7,3,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,0],"type":"scatter"},{"mode":"lines","name":"H1","showlegend":true,"x":[79.8254165649414,83.29033738739636,86.75525820985132,90.22017903230628,93.68509985476123,97.15002067721619,100.61494149967116,104.07986232212612,107.54478314458107,111.00970396703603,114.47462478949099,117.93954561194596,121.40446643440092,124.86938725685587,128.33430807931083,131.7992289017658,135.26414972422074,138.7290705466757,142.19399136913066,145.6589121915856,149.12383301404057,152.58875383649553,156.0536746589505,159.51859548140544,162.98351630386043,166.44843712631535,169.91335794877034,173.37827877122527,176.84319959368025,180.3081204161352,183.77304123859017,187.23796206104512,190.70288288350008,194.16780370595504,197.63272452841,201.09764535086495,204.5625661733199,208.02748699577486,211.49240781822982,214.95732864068478,218.42224946313974,221.88717028559472,225.35209110804968,228.81701193050463,232.2819327529596,235.74685357541455,239.2117743978695,242.67669522032446,246.14161604277942,249.60653686523438],"y":[1,1,2,2,1,1,2,2,3,3,4,6,5,4,4,5,3,5,5,5,6,6,6,6,5,4,6,7,8,9,9,9,9,8,7,7,6,6,5,5,6,6,6,6,5,3,2,2,2,0],"type":"scatter"},{"mode":"lines","name":"H2","showlegend":true,"x":[169.2471466064453,171.92192233338648,174.59669806032764,177.2714737872688,179.94624951420997,182.62102524115116,185.29580096809232,187.9705766950335,190.64535242197465,193.3201281489158,195.99490387585698,198.66967960279814,201.34445532973933,204.0192310566805,206.69400678362166,209.36878251056282,212.043558237504,214.71833396444515,217.39310969138631,220.06788541832748,222.74266114526864,225.4174368722098,228.092212599151,230.76698832609216,233.44176405303332,236.1165397799745,238.79131550691565,241.46609123385684,244.140866960798,246.81564268773917,249.49041841468033,252.1651941416215,254.83996986856266,257.5147455955038,260.189521322445,262.86429704938615,265.5390727763273,268.2138485032685,270.88862423020964,273.56339995715086,276.23817568409197,278.9129514110332,281.5877271379743,284.2625028649155,286.9372785918567,289.61205431879785,292.286830045739,294.9616057726802,297.63638149962134,300.3111572265625],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,2,3,4,4,4,3,4,4,5,5,5,3,2,0],"type":"scatter"}],                        {"plot_bgcolor":"white","title":{"text":"Betti curves from diagram 0"},"xaxis":{"anchor":"y","exponentformat":"e","linecolor":"black","linewidth":1,"mirror":false,"showexponent":"all","showline":true,"side":"bottom","ticks":"outside","title":{"text":"Filtration parameter"},"type":"linear","zeroline":true},"yaxis":{"anchor":"x","exponentformat":"e","linecolor":"black","linewidth":1,"mirror":false,"showexponent":"all","showline":true,"side":"left","ticks":"outside","title":{"text":"Betti number"},"type":"linear","zeroline":true},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('4bdf4ea5-28ba-45c2-924b-987a73652217');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [100]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># n_components = 4</span>

<span class="c1"># X_pls = pls_transformed_X[n_components - 1]</span>

<span class="c1"># X_pca = pca_transformed_X[n_components - 1]</span>

<span class="c1"># from gtda.homology import WeakAlphaPersistence</span>

<span class="c1"># wa_pers = WeakAlphaPersistence(homology_dimensions=(0, 1, 2))</span>

<span class="c1"># diagrams_wa_pers = wa_pers.fit_transform([X_pca, X_pls])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">_RemoteTraceback</span>                          Traceback (most recent call last)
<span class="ansi-red-fg">_RemoteTraceback</span>:
&#34;&#34;&#34;
Traceback (most recent call last):
  File &#34;/home/facosta/miniconda3/envs/neurometry/lib/python3.9/site-packages/joblib/externals/loky/process_executor.py&#34;, line 463, in _process_worker
    r = call_item()
  File &#34;/home/facosta/miniconda3/envs/neurometry/lib/python3.9/site-packages/joblib/externals/loky/process_executor.py&#34;, line 291, in __call__
    return self.fn(*self.args, **self.kwargs)
  File &#34;/home/facosta/miniconda3/envs/neurometry/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 589, in __call__
    return [func(*args, **kwargs)
  File &#34;/home/facosta/miniconda3/envs/neurometry/lib/python3.9/site-packages/joblib/parallel.py&#34;, line 589, in &lt;listcomp&gt;
    return [func(*args, **kwargs)
  File &#34;/home/facosta/miniconda3/envs/neurometry/lib/python3.9/site-packages/gtda/homology/simplicial.py&#34;, line 1110, in _weak_alpha_diagram
    indptr, indices = Delaunay(X).vertex_neighbor_vertices
  File &#34;_qhull.pyx&#34;, line 1827, in scipy.spatial._qhull.Delaunay.__init__
  File &#34;_qhull.pyx&#34;, line 353, in scipy.spatial._qhull._Qhull.__init__
scipy.spatial._qhull.QhullError: QH6154 Qhull precision error: Initial simplex is flat (facet 1 is coplanar with the interior point)

While executing:  | qhull d Qt Q12 Qx Qc Qz Qbb
Options selected for Qhull 2019.1.r 2019/06/21:
  run-id 1336544124  delaunay  Qtriangulate  Q12-allow-wide  Qxact-merge
  Qcoplanar-keep  Qz-infinity-point  Qbbound-last  _zero-centrum
  Qinterior-keep  Q3-no-merge-vertices-dim-high  Pgood  _max-width 2.8e+02
  Error-roundoff 1.4e-11  _one-merge 1.2e-09  Visible-distance 8.6e-11
  U-max-coplanar 8.6e-11  Width-outside 1.7e-10  _wide-facet 5.2e-10
  _maxoutside 1.2e-09

precision problems (corrected unless &#39;Q0&#39; or an error)
     42 nearly singular or axis-parallel hyperplanes
      7 zero divisors during gaussian elimination

The input to qhull appears to be less than 41 dimensional, or a
computation has overflowed.

Qhull could not construct a clearly convex simplex from points:
- p14(v42): 1.6e+02    68 1e+02    91 1.6e+02 1e+02    40 1.5e+02 1.2e+02 1e+02 1.3e+02    71    85 1.2e+02    40    69    90    64 1.3e+02 1.1e+02 1e+02 1.1e+02    95 1.1e+02    95 1.3e+02    96    85    78    92 1e+02 1e+02 1.1e+02    73 1.2e+02    45    97    68    98    78    23
- p13(v41): 2e+02    41    64 1.1e+02 1.6e+02 1.1e+02 1.3e+02 1.2e+02 1.5e+02 1.3e+02 2e+02    48    71    51    56    44    45 1.4e+02 1.2e+02    91 1.2e+02 1.2e+02 1e+02    60    91 1.2e+02    84    90    99    74    99    69    72 1.2e+02 1.1e+02    82 1e+02    91 1.1e+02 1e+02    71
- p12(v40):  -3.9 1.4e+02 1.1e+02    22    40 1.3e+02 1.1e+02    24   1.3    32    77 1.1e+02 1.1e+02 1.7e+02 1.6e+02 1.8e+02 2e+02    47 1.4e+02 1.8e+02    98 1.2e+02    82    67    61 1.3e+02 1e+02    89    81    88    86    68 1e+02 1.1e+02 1e+02    74    85 1e+02 1.3e+02    93    76
- p11(v39): 1.9e+02    53    66 1.4e+02 1.5e+02 1e+02 1.3e+02 1.3e+02 1.6e+02 1.4e+02 1.8e+02    65    82    37    61    41    32 1.5e+02    95    64 1.2e+02 1.1e+02 1e+02    75 1e+02 1.1e+02    88 1e+02 1.1e+02    83 1e+02    86    78 1.2e+02 1e+02 1e+02    98    98 1.1e+02 1e+02    80
- p10(v38): 1.9e+02    54 1.2e+02 1.1e+02 1.8e+02    70   3.5 1.9e+02 1.7e+02 1.2e+02 1.2e+02    78    81 1e+02    19    42    50    65 1.2e+02    70    89    87 1.2e+02 1.8e+02 1.5e+02    74    93 1.1e+02 1.3e+02 1.3e+02    80 1.6e+02 1.1e+02    52 1.3e+02 1.1e+02 1.2e+02    77    79    76 1.2e+02
- p9(v37):    64    98    82    68    65 1.2e+02 1.8e+02    22    77    73 1.5e+02    89    86    72 1.6e+02 1.3e+02 1.1e+02 1.4e+02 1.1e+02 1.3e+02 1.1e+02 1.1e+02 1.1e+02    71 1e+02    66    84 1.1e+02 1.6e+02 1e+02    59    72    54 1.5e+02 1.1e+02 1.8e+02 1.1e+02 1.4e+02 1.3e+02 1.2e+02 1.1e+02
- p8(v36): 1e+02    79    97    54 1.1e+02 1.2e+02 1.2e+02    67    90    68 1.5e+02    74    77    99 1.2e+02 1.1e+02 1.1e+02    96 1.4e+02 1.4e+02 1e+02 1.2e+02 1.1e+02    95 1e+02    81    85 1e+02 1.4e+02 1.1e+02    62    86    68 1.1e+02 1.2e+02 1.4e+02 1.1e+02 1.2e+02 1.2e+02 1e+02    55
- p7(v35):    32 1.3e+02 1.2e+02    33    68 1.3e+02    73    60    18    45    81 1e+02 1e+02 1.8e+02 1.2e+02 1.6e+02 1.9e+02    32 1.4e+02 1.8e+02    99 1.2e+02    76    69    56 1.5e+02 1e+02    80    57    80 1e+02    71 1.2e+02    92 1e+02    34    80    83 1.2e+02    82    39
- p6(v34):    26 1.3e+02    86    44    46 1.4e+02 1.5e+02    16    13    54 1.2e+02    95 1e+02 1.4e+02 1.6e+02 1.6e+02 1.8e+02    86 1.3e+02 1.7e+02 1.1e+02 1.3e+02    76    20    42 1.5e+02    98    83    63    61 1e+02    36    93 1.3e+02    90    56    76 1e+02 1.4e+02 1e+02    59
- p4(v33): 1.2e+02    69    83    45 1.2e+02 1.4e+02 1.1e+02    69    74    68 1.8e+02    55    72 1.1e+02    98 1.1e+02 1.2e+02    83 1.5e+02 1.6e+02 1.1e+02 1.3e+02    96    49    67 1.3e+02    86    77    92    75    85    52    75 1.1e+02 1.2e+02    69    99    93 1.2e+02    99    32
- p3(v32): 1.4e+02    76    68 1.1e+02 1.1e+02 1.2e+02 1.5e+02    86 1.2e+02 1.2e+02 1.6e+02    75    88    59    98    77    71 1.5e+02 1e+02    94 1.2e+02 1.1e+02    97    54    87 1.2e+02    89 1e+02 1e+02    76 1e+02    68    77 1.3e+02    98    98    92 1.1e+02 1.2e+02 1.1e+02    42
- p2(v31): 2.1e+02    53    77 1.3e+02 1.8e+02 1e+02    56 1.8e+02 1.4e+02 1.4e+02 1.6e+02    57    88    95   4.3    34    60    91 1.2e+02    84 1.2e+02 1.1e+02    78    62    70 1.8e+02 1e+02    72    26    55 1.4e+02    79 1.2e+02    79    98   -22    76    44 1e+02    75    60
- p0(v30):   9.4 1.4e+02 1.3e+02    18    60 1.2e+02    62    53    14    30    63 1.1e+02 1e+02 1.9e+02 1.4e+02 1.7e+02 2e+02    20 1.4e+02 1.8e+02    89 1.1e+02    87 1e+02    75 1.2e+02 1e+02    89    87 1e+02    81    91 1.1e+02    86 1.1e+02    73    92    95 1.2e+02    83    69
- p20(v29):    19 1.5e+02    91 1.2e+02    24 1e+02 1.7e+02    40    62 1e+02    53 1.4e+02 1.3e+02    91 1.7e+02 1.4e+02 1.3e+02 1.4e+02    59    94 1.1e+02    94    86    72    91    96 1e+02 1.2e+02 1e+02    92 1e+02    89 1e+02 1.4e+02    75 1.3e+02    78 1.3e+02 1.2e+02 1.1e+02    75
- p1(v28):     3 1.5e+02 1.1e+02    30    44 1.4e+02    91    39  -6.7    40    68 1.1e+02 1.1e+02 1.9e+02 1.4e+02 1.8e+02 2.1e+02    34 1.3e+02 1.9e+02 1e+02 1.2e+02    67    48    40 1.6e+02 1.1e+02    77    40    69 1.1e+02    57 1.2e+02 1e+02    90    18    70    84 1.3e+02    84    67
- p35(v27): 1.3e+02    75 1.1e+02    48 1.4e+02 1.1e+02    31 1.2e+02    86    68 1.4e+02    69    80 1.5e+02    60    99 1.3e+02    34 1.6e+02 1.5e+02    98 1.2e+02    95 1e+02    84 1.3e+02    95    77    81    94    90    93 1.1e+02    70 1.2e+02    44 1e+02    70 1e+02    77    23
- p25(v26):    49 1e+02 1e+02    46    68 1.2e+02 1.4e+02    30    65    55 1.3e+02    94    86 1e+02 1.6e+02 1.4e+02 1.3e+02 1e+02 1.2e+02 1.4e+02 1e+02 1.1e+02 1.1e+02    94 1.1e+02    63    86 1.1e+02 1.6e+02 1.2e+02    53    86    64 1.3e+02 1.2e+02 1.7e+02 1.1e+02 1.4e+02 1.2e+02 1.1e+02    93
- p98(v25): 1.9e+02    61    61 1.7e+02 1.4e+02    93 1.5e+02 1.3e+02 1.7e+02 1.6e+02 1.6e+02    76    92    19    64    33    16 1.8e+02    70    38 1.3e+02    97 1e+02    73 1.1e+02 1.1e+02    91 1.1e+02 1e+02    81 1.1e+02    91    83 1.3e+02    93 1e+02    92 1e+02 1.1e+02 1.1e+02 1e+02
- p52(v24): 2e+02    47    45 1.6e+02 1.4e+02 1.1e+02 1.9e+02 1e+02 1.7e+02 1.6e+02 2e+02    60    79  -5.3    82    32   6.8 2e+02    79    48 1.3e+02 1.1e+02 1.1e+02    51 1.1e+02    97    82 1.1e+02 1.2e+02    76    99    70    57 1.5e+02    98 1.3e+02    99 1.2e+02 1.1e+02 1.2e+02 1.5e+02
- p84(v23): 1.8e+02 1.1e+02    62 2.3e+02 1.2e+02    77 1.2e+02 1.8e+02 1.6e+02 2.1e+02    72 1.2e+02 1.3e+02    48    33    31    29 1.7e+02    21   2.4 1.3e+02    83    59    51    75 1.8e+02 1.2e+02 1e+02   0.5    44 1.9e+02    95 1.5e+02 1.1e+02    49   -15    45    59    98    84 1.2e+02
- p43(v22): 1.7e+02 1e+02 1.1e+02 2.1e+02 1.3e+02    48    56 2e+02 1.8e+02 1.8e+02    32 1.3e+02 1.3e+02    67    30    36    26 1.3e+02    30  -4.4 1e+02    62    89 1.5e+02 1.4e+02 1e+02 1.1e+02 1.3e+02    76 1.1e+02 1.4e+02 1.6e+02 1.4e+02    73    80    71    79    75    77    77 1.3e+02
- p18(v21): 1.5e+02 1.1e+02 1e+02 2.1e+02 1.2e+02    51    85 1.8e+02 1.8e+02 1.8e+02    42 1.3e+02 1.3e+02    51    53    42    22 1.5e+02    27  -4.2 1e+02    62    97 1.5e+02 1.4e+02    83 1.1e+02 1.3e+02 1e+02 1.2e+02 1.2e+02 1.6e+02 1.3e+02    88    83 1.1e+02    86    93    82    87 1.3e+02
- p16(v20): 1.3e+02    76    46 1.2e+02    89 1.3e+02 2.2e+02    46 1.1e+02 1.2e+02 1.9e+02    70    86    29 1.3e+02    83    65 1.9e+02    92    94 1.3e+02 1.2e+02    97    16    76 1.2e+02    84 1e+02 1.1e+02    62    99    40    57 1.6e+02    90 1.2e+02    89 1.3e+02 1.3e+02 1.2e+02 1e+02
- p5(v19): 1.3e+02 1.2e+02    87 2e+02    93    70 1.1e+02 1.6e+02 1.4e+02 1.8e+02    38 1.3e+02 1.4e+02    68    67    63    54 1.5e+02    26    17 1.2e+02    75    74    95 1e+02 1.4e+02 1.2e+02 1.2e+02    47    79 1.5e+02 1.2e+02 1.4e+02 1e+02    62    47    62    81    95    86    72
- p44(v18):    85 1.3e+02    94 1.6e+02    71    82 1.3e+02 1e+02 1.2e+02 1.4e+02    56 1.3e+02 1.2e+02    72 1.1e+02    95    77 1.4e+02    48    52 1.1e+02    81    92 1.1e+02 1.1e+02    92 1.1e+02 1.3e+02 1e+02 1e+02 1.1e+02 1.2e+02 1.1e+02 1.2e+02    80 1.2e+02    83 1.1e+02 1e+02 1e+02    57
- p51(v17): 1.5e+02    60    89    74 1.4e+02 1.1e+02    96 1e+02 1.1e+02    90 1.7e+02    61    73    92    79    80    87    96 1.4e+02 1.2e+02 1.1e+02 1.2e+02 1.1e+02    87    97 1e+02    86    92 1.2e+02    95    79    84    76 1e+02 1.2e+02 1e+02 1.1e+02    97 1.1e+02    98    38
- p47(v16):    30 1.6e+02 1.1e+02 1.4e+02    41    87 1e+02    99    65 1.1e+02  -1.9 1.5e+02 1.4e+02 1.3e+02 1.2e+02 1.3e+02 1.4e+02    94    52    81 1e+02    83    69    96    85 1.3e+02 1.2e+02 1.1e+02    50    88 1.3e+02 1.1e+02 1.5e+02    98    66    52    62    90 1.1e+02    84    43
- p92(v15): 1.9e+02    56    78 1.6e+02 1.5e+02    78 1.3e+02 1.4e+02 1.9e+02 1.6e+02 1.5e+02    82    86    13    66    30   2.5 1.7e+02    70    27 1.1e+02    86 1.2e+02 1.2e+02 1.4e+02    58    86 1.3e+02 1.5e+02 1.2e+02    85 1.3e+02    73 1.2e+02 1.1e+02 1.7e+02 1.1e+02 1.2e+02    95 1.1e+02 1.6e+02
- p54(v14): 1.6e+02    98    99 1.9e+02 1.3e+02    64    64 1.9e+02 1.6e+02 1.7e+02    59 1.2e+02 1.2e+02    76    35    44    42 1.2e+02    50    22 1.1e+02    75    86 1.3e+02 1.2e+02 1.2e+02 1.1e+02 1.2e+02    67    96 1.4e+02 1.4e+02 1.4e+02    79    83    56    79    72    85    79    79
- p55(v13): 1.5e+02    49 1.2e+02    24 1.6e+02 1.1e+02    37 1.1e+02 1.1e+02    52 1.7e+02    51    58 1.3e+02    69    91 1.1e+02    41 1.8e+02 1.6e+02    92 1.2e+02 1.2e+02 1.3e+02 1.1e+02    82    81    86 1.4e+02 1.2e+02    50 1.1e+02    73    75 1.5e+02 1.2e+02 1.3e+02    93 1e+02    88    85
- p73(v12): 2.1e+02    46    66 1.7e+02 1.6e+02    85 1.3e+02 1.5e+02 1.9e+02 1.7e+02 1.7e+02    70    84    10    49    18  -2.6 1.8e+02    74    29 1.2e+02    93 1.1e+02    97 1.3e+02    88    87 1.2e+02 1.2e+02    95 1e+02 1.1e+02    77 1.2e+02 1e+02 1.3e+02 1e+02 1e+02    99 1.1e+02 1.5e+02
- p48(v11): 1.3e+02    58 1.1e+02   2.8 1.6e+02 1.3e+02    25 1e+02    67    38 1.8e+02    45    62 1.7e+02    63 1.1e+02 1.5e+02    11 1.9e+02 1.9e+02    97 1.4e+02 1e+02    88    72 1.4e+02    87    62    88    91    74    73    90    70 1.4e+02    41 1.1e+02    69 1.1e+02    79    63
- p100(v10): 1.1e+02    99    97 1.1e+02 1e+02 1e+02 1e+02 1e+02 1e+02 1.1e+02 1e+02    98 1e+02    97    96    96    95 1.1e+02    97    96 1.1e+02 1e+02    96    97 1e+02 1.1e+02    98 1.1e+02 1e+02    97    98 1e+02 1e+02 1e+02 1e+02    96    93    99 1.1e+02    95 2.4e+02
- p60(v9): 2e+02    59    84 1.1e+02 1.7e+02 1.1e+02    45 1.7e+02 1.2e+02 1.2e+02 1.5e+02    58    87 1.2e+02    13    50    82    71 1.3e+02 1.1e+02 1.2e+02 1.2e+02    77    63    64 1.8e+02 1e+02    68    25    57 1.4e+02    76 1.2e+02    75 1e+02   -26    77    43 1e+02    73    41
- p74(v8):  0.33 1.6e+02 1.2e+02    79    35 1e+02    91    64    30    70    17 1.4e+02 1.3e+02 1.6e+02 1.4e+02 1.6e+02 1.7e+02    61    90 1.3e+02    95    97    76    97    80 1.2e+02 1.1e+02 1.1e+02    70    97 1.1e+02 1e+02 1.3e+02    97    84    70    74    98 1.1e+02    86    51
- p96(v7):   5.7 1.5e+02 1.4e+02    63    49    98    63    75    39    58    17 1.4e+02 1.2e+02 1.7e+02 1.4e+02 1.6e+02 1.7e+02    42 1e+02 1.4e+02    85    94    87 1.3e+02    98    98 1.1e+02 1.1e+02    95 1.2e+02    89 1.2e+02 1.3e+02    84    99    95    89 1e+02 1.1e+02    82    64
- p81(v6): 2.2e+02    53    46 1.8e+02 1.6e+02 1e+02 1.4e+02 1.5e+02 1.7e+02 1.8e+02 1.8e+02    62    93    29    30    17    17 1.7e+02    76    42 1.4e+02 1.1e+02    81    33    75 1.7e+02    96    90    42    45 1.5e+02    65 1e+02 1.2e+02    81    20    71    70 1.1e+02    97 1.1e+02
- p86(v5):    30 1.5e+02 1.1e+02 1.5e+02    34    69 1.6e+02    70 1.1e+02 1.2e+02    19 1.6e+02 1.3e+02    62 1.6e+02 1.2e+02    82 1.6e+02    32    44    94    65 1.1e+02 1.5e+02 1.5e+02    21 1e+02 1.6e+02 1.7e+02 1.4e+02    74 1.5e+02    94 1.3e+02    89 2.2e+02 1e+02 1.5e+02 1e+02 1.1e+02 1.8e+02
- p19(v4):    46 1.2e+02    57    87    37 1.5e+02 2.2e+02   6.4    36    89 1.4e+02    94 1.1e+02    87 1.7e+02 1.4e+02 1.4e+02 1.5e+02    98 1.4e+02 1.3e+02 1.3e+02    75   -11    40 1.5e+02    95    93    64    45 1.1e+02    19    80 1.6e+02    75    71    68 1.2e+02 1.4e+02 1.2e+02    83
- p94(v3): 1.5e+02    45    87    25 1.5e+02 1.4e+02    84    84    85    58 2.1e+02    35    56 1.2e+02    76    93 1.2e+02    64 1.8e+02 1.7e+02 1.1e+02 1.4e+02 1e+02    60    72 1.3e+02    80    69 1e+02    80    73    54    68 1e+02 1.3e+02    69 1.1e+02    86 1.2e+02    95    59
- p46(v2): 2.4e+02    48    72 1.8e+02 1.9e+02    85    65 2e+02 1.9e+02 1.8e+02 1.5e+02    65    93    58  -9.6     5    17 1.3e+02    85    37 1.2e+02    99    84    81    92 1.6e+02 1e+02    88    39    64 1.5e+02 1e+02 1.2e+02    81    92   2.2    78    50    91    78 1.1e+02
- p79(v1):   -34 1.7e+02 1.2e+02    51     9 1.2e+02 1.3e+02    17   1.5    47    32 1.4e+02 1.2e+02 1.6e+02 1.8e+02 1.9e+02 2e+02    68 1e+02 1.6e+02    97 1.1e+02    79    76    71 1.1e+02 1.1e+02 1.1e+02    86    95    93    83 1.1e+02 1.2e+02    86    95    78 1.2e+02 1.3e+02    97    99

The center point is coplanar with a facet, or a vertex is coplanar
with a neighboring facet.  The maximum round off error for
computing distances is 1.4e-11.  The center point, facets and distances
to the center point are as follows:

center point    115.5    93.65    91.29    106.3    107.1    104.5    107.2    103.4    104.2    107.5    116.2    91.82     98.3    95.25    90.88    91.65    94.38    107.4      101    99.07    109.6    104.7    92.77    84.38    92.46      117    97.12    100.6    90.38    88.37    102.9    91.85    99.54      106    99.45     82.5     90.1    94.75    109.3    94.69    86.16

facet p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.8e-14
facet p14 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.4e-14
facet p14 p13 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -3.6e-14
facet p14 p13 p12 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -2.8e-14
facet p14 p13 p12 p11 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -2.1e-14
facet p14 p13 p12 p11 p10 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -2.6e-14
facet p14 p13 p12 p11 p10 p9 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -6.6e-15
facet p14 p13 p12 p11 p10 p9 p8 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -4.4e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.2e-16
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -4e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -6e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -4.6e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -5.3e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.6e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.7e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -3.9e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -2.6e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -6e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -4e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -8.3e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -9.1e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -2.6e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -2.3e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -9.3e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.1e-13
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -7.9e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -7.4e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.9e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -2.5e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -4.2e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -5e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.5e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.4e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p74 p96 p81 p86 p19 p94 p46 p79 distance= -5.4e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p96 p81 p86 p19 p94 p46 p79 distance= -4.4e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p81 p86 p19 p94 p46 p79 distance= -1.2e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p86 p19 p94 p46 p79 distance= -7.4e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p19 p94 p46 p79 distance= -3.4e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p94 p46 p79 distance= -2.7e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p46 p79 distance= -1e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p79 distance= -3.2e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 distance= -1.4e-14

These points either have a maximum or minimum x-coordinate, or
they maximize the determinant for k coordinates.  Trial points
are first selected from points that maximize a coordinate.

Because of the high dimension, the min x-coordinate and max-coordinate
points are used if the determinant is non-zero.  Option &#39;Qs&#39; will
do a better, though much slower, job.  Instead of &#39;Qs&#39;, you can change
the points by randomly rotating the input with &#39;QR0&#39;.

The min and max coordinates for each dimension are:
  0:    -34.17     242.8  difference= 276.9
  1:     41.16     170.2  difference=  129
  2:     44.87     144.1  difference= 99.26
  3:    -8.179       233  difference= 241.1
  4:     8.965     188.5  difference= 179.5
  5:     47.84     145.2  difference= 97.33
  6:    -2.737     218.1  difference= 220.9
  7:    -12.18     204.8  difference=  217
  8:    -6.742     198.8  difference= 205.6
  9:     7.474     206.9  difference= 199.4
  10:    -19.73     213.7  difference= 233.4
  11:      34.9     158.6  difference= 123.7
  12:     56.27     147.8  difference= 91.56
  13:     -5.28     206.4  difference= 211.7
  14:    -9.578     192.3  difference= 201.9
  15:     4.992     190.1  difference= 185.2
  16:    -4.608     209.4  difference=  214
  17:     2.683     204.3  difference= 201.6
  18:        21     194.6  difference= 173.6
  19:    -4.403     199.5  difference= 203.9
  20:     80.48     136.5  difference= 56.07
  21:     62.07     138.9  difference= 76.82
  22:     59.19     129.1  difference= 69.96
  23:    -10.94     185.3  difference= 196.2
  24:     40.24     152.6  difference= 112.3
  25:     21.15     183.6  difference= 162.5
  26:     78.41     120.4  difference= 41.96
  27:     62.19     156.4  difference= 94.22
  28:    0.4971     179.8  difference= 179.3
  29:      43.8     143.4  difference= 99.65
  30:     36.92     185.1  difference= 148.2
  31:     19.33     178.3  difference=  159
  32:     44.23     156.2  difference=  112
  33:     51.54     163.7  difference= 112.1
  34:     48.53       150  difference= 101.5
  35:       -26     220.3  difference= 246.3
  36:     44.64     133.6  difference= 88.94
  37:     43.41     154.3  difference= 110.8
  38:     75.61     142.4  difference= 66.82
  39:     64.55     127.9  difference= 63.31
  40:         0     242.8  difference= 242.8

If the input should be full dimensional, you have several options that
may determine an initial simplex:
  - use &#39;QJ&#39;  to joggle the input and make it full dimensional
  - use &#39;QbB&#39; to scale the points to the unit cube
  - use &#39;QR0&#39; to randomly rotate the input for different maximum points
  - use &#39;Qs&#39;  to search all points for the initial simplex
  - use &#39;En&#39;  to specify a maximum roundoff error less than 1.4e-11.
  - trace execution with &#39;T3&#39; to see the determinant for each point.

If the input is lower dimensional:
  - use &#39;QJ&#39; to joggle the input and make it full dimensional
  - use &#39;Qbk:0Bk:0&#39; to delete coordinate k from the input.  You should
    pick the coordinate with the least range.  The hull will have the
    correct topology.
  - determine the flat containing the points, rotate the points
    into a coordinate plane, and delete the other coordinates.
  - add one or more points to make the input full dimensional.

&#34;&#34;&#34;

The above exception was the direct cause of the following exception:

<span class="ansi-red-fg">QhullError</span>                                Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[100], line 12</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">gtda</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">homology</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> WeakAlphaPersistence
<span class="ansi-green-intense-fg ansi-bold">     10</span> wa_pers <span style="color: rgb(98,98,98)">=</span> WeakAlphaPersistence(homology_dimensions<span style="color: rgb(98,98,98)">=</span>(<span style="color: rgb(98,98,98)">0</span>, <span style="color: rgb(98,98,98)">1</span>, <span style="color: rgb(98,98,98)">2</span>), n_jobs<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">-</span><span style="color: rgb(98,98,98)">1</span>)
<span class="ansi-green-fg">---&gt; 12</span> diagrams_wa_pers <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">wa_pers</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit_transform</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">X_pca</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">X_pls</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/miniconda3/envs/neurometry/lib/python3.9/site-packages/gtda/utils/_docs.py:106</span>, in <span class="ansi-cyan-fg">adapt_fit_transform_docs.&lt;locals&gt;.make_new_fit_transform.&lt;locals&gt;.fit_transform_wrapper</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    104</span> <span style="color: rgb(175,0,255)">@wraps</span>(original_fit_transform)
<span class="ansi-green-intense-fg ansi-bold">    105</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">fit_transform_wrapper</span>(<span style="color: rgb(98,98,98)">*</span>args, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs):
<span class="ansi-green-fg">--&gt; 106</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">original_fit_transform</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/miniconda3/envs/neurometry/lib/python3.9/site-packages/sklearn/utils/_set_output.py:295</span>, in <span class="ansi-cyan-fg">_wrap_method_output.&lt;locals&gt;.wrapped</span><span class="ansi-blue-fg">(self, X, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    293</span> <span style="color: rgb(175,0,255)">@wraps</span>(f)
<span class="ansi-green-intense-fg ansi-bold">    294</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">wrapped</span>(<span style="color: rgb(0,135,0)">self</span>, X, <span style="color: rgb(98,98,98)">*</span>args, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs):
<span class="ansi-green-fg">--&gt; 295</span>     data_to_wrap <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">f</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    296</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(data_to_wrap, <span style="color: rgb(0,135,0)">tuple</span>):
<span class="ansi-green-intense-fg ansi-bold">    297</span>         <span style="color: rgb(95,135,135)"># only wrap the first output for cross decomposition</span>
<span class="ansi-green-intense-fg ansi-bold">    298</span>         return_tuple <span style="color: rgb(98,98,98)">=</span> (
<span class="ansi-green-intense-fg ansi-bold">    299</span>             _wrap_data_with_container(method, data_to_wrap[<span style="color: rgb(98,98,98)">0</span>], X, <span style="color: rgb(0,135,0)">self</span>),
<span class="ansi-green-intense-fg ansi-bold">    300</span>             <span style="color: rgb(98,98,98)">*</span>data_to_wrap[<span style="color: rgb(98,98,98)">1</span>:],
<span class="ansi-green-intense-fg ansi-bold">    301</span>         )

File <span class="ansi-green-fg">~/miniconda3/envs/neurometry/lib/python3.9/site-packages/sklearn/base.py:1098</span>, in <span class="ansi-cyan-fg">TransformerMixin.fit_transform</span><span class="ansi-blue-fg">(self, X, y, **fit_params)</span>
<span class="ansi-green-intense-fg ansi-bold">   1083</span>         warnings<span style="color: rgb(98,98,98)">.</span>warn(
<span class="ansi-green-intense-fg ansi-bold">   1084</span>             (
<span class="ansi-green-intense-fg ansi-bold">   1085</span>                 <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">This object (</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__class__</span><span style="color: rgb(98,98,98)">.</span><span style="color: rgb(0,0,135)">__name__</span><span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">) has a `transform`</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">   1093</span>             <span class="ansi-bold" style="color: rgb(215,95,95)">UserWarning</span>,
<span class="ansi-green-intense-fg ansi-bold">   1094</span>         )
<span class="ansi-green-intense-fg ansi-bold">   1096</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> y <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">   1097</span>     <span style="color: rgb(95,135,135)"># fit method of arity 1 (unsupervised transformation)</span>
<span class="ansi-green-fg">-&gt; 1098</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">fit_params</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">transform</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1099</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">   1100</span>     <span style="color: rgb(95,135,135)"># fit method of arity 2 (supervised transformation)</span>
<span class="ansi-green-intense-fg ansi-bold">   1101</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>fit(X, y, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>fit_params)<span style="color: rgb(98,98,98)">.</span>transform(X)

File <span class="ansi-green-fg">~/miniconda3/envs/neurometry/lib/python3.9/site-packages/sklearn/utils/_set_output.py:295</span>, in <span class="ansi-cyan-fg">_wrap_method_output.&lt;locals&gt;.wrapped</span><span class="ansi-blue-fg">(self, X, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    293</span> <span style="color: rgb(175,0,255)">@wraps</span>(f)
<span class="ansi-green-intense-fg ansi-bold">    294</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">wrapped</span>(<span style="color: rgb(0,135,0)">self</span>, X, <span style="color: rgb(98,98,98)">*</span>args, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs):
<span class="ansi-green-fg">--&gt; 295</span>     data_to_wrap <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">f</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    296</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(data_to_wrap, <span style="color: rgb(0,135,0)">tuple</span>):
<span class="ansi-green-intense-fg ansi-bold">    297</span>         <span style="color: rgb(95,135,135)"># only wrap the first output for cross decomposition</span>
<span class="ansi-green-intense-fg ansi-bold">    298</span>         return_tuple <span style="color: rgb(98,98,98)">=</span> (
<span class="ansi-green-intense-fg ansi-bold">    299</span>             _wrap_data_with_container(method, data_to_wrap[<span style="color: rgb(98,98,98)">0</span>], X, <span style="color: rgb(0,135,0)">self</span>),
<span class="ansi-green-intense-fg ansi-bold">    300</span>             <span style="color: rgb(98,98,98)">*</span>data_to_wrap[<span style="color: rgb(98,98,98)">1</span>:],
<span class="ansi-green-intense-fg ansi-bold">    301</span>         )

File <span class="ansi-green-fg">~/miniconda3/envs/neurometry/lib/python3.9/site-packages/gtda/homology/simplicial.py:1208</span>, in <span class="ansi-cyan-fg">WeakAlphaPersistence.transform</span><span class="ansi-blue-fg">(self, X, y)</span>
<span class="ansi-green-intense-fg ansi-bold">   1205</span> check_is_fitted(<span style="color: rgb(0,135,0)">self</span>)
<span class="ansi-green-intense-fg ansi-bold">   1206</span> X <span style="color: rgb(98,98,98)">=</span> check_point_clouds(X)
<span class="ansi-green-fg">-&gt; 1208</span> Xt <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">Parallel</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">n_jobs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">n_jobs</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">   1209</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">delayed</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_weak_alpha_diagram</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">for</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(175,0,255)">in</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1211</span> Xt <span style="color: rgb(98,98,98)">=</span> _postprocess_diagrams(
<span class="ansi-green-intense-fg ansi-bold">   1212</span>     Xt, <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">ripser</span><span style="color: rgb(175,0,0)">&#34;</span>, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_homology_dimensions, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>infinity_values_,
<span class="ansi-green-intense-fg ansi-bold">   1213</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>reduced_homology
<span class="ansi-green-intense-fg ansi-bold">   1214</span>     )
<span class="ansi-green-intense-fg ansi-bold">   1215</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> Xt

File <span class="ansi-green-fg">~/miniconda3/envs/neurometry/lib/python3.9/site-packages/joblib/parallel.py:1952</span>, in <span class="ansi-cyan-fg">Parallel.__call__</span><span class="ansi-blue-fg">(self, iterable)</span>
<span class="ansi-green-intense-fg ansi-bold">   1946</span> <span style="color: rgb(95,135,135)"># The first item from the output is blank, but it makes the interpreter</span>
<span class="ansi-green-intense-fg ansi-bold">   1947</span> <span style="color: rgb(95,135,135)"># progress until it enters the Try/Except block of the generator and</span>
<span class="ansi-green-intense-fg ansi-bold">   1948</span> <span style="color: rgb(95,135,135)"># reach the first `yield` statement. This starts the aynchronous</span>
<span class="ansi-green-intense-fg ansi-bold">   1949</span> <span style="color: rgb(95,135,135)"># dispatch of the tasks to the workers.</span>
<span class="ansi-green-intense-fg ansi-bold">   1950</span> <span style="color: rgb(0,135,0)">next</span>(output)
<span class="ansi-green-fg">-&gt; 1952</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> output <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>return_generator <span class="ansi-bold" style="color: rgb(0,135,0)">else</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">list</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">output</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/miniconda3/envs/neurometry/lib/python3.9/site-packages/joblib/parallel.py:1595</span>, in <span class="ansi-cyan-fg">Parallel._get_outputs</span><span class="ansi-blue-fg">(self, iterator, pre_dispatch)</span>
<span class="ansi-green-intense-fg ansi-bold">   1592</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">yield</span>
<span class="ansi-green-intense-fg ansi-bold">   1594</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_backend<span style="color: rgb(98,98,98)">.</span>retrieval_context():
<span class="ansi-green-fg">-&gt; 1595</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">yield from</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_retrieve()
<span class="ansi-green-intense-fg ansi-bold">   1597</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">GeneratorExit</span>:
<span class="ansi-green-intense-fg ansi-bold">   1598</span>     <span style="color: rgb(95,135,135)"># The generator has been garbage collected before being fully</span>
<span class="ansi-green-intense-fg ansi-bold">   1599</span>     <span style="color: rgb(95,135,135)"># consumed. This aborts the remaining tasks if possible and warn</span>
<span class="ansi-green-intense-fg ansi-bold">   1600</span>     <span style="color: rgb(95,135,135)"># the user if necessary.</span>
<span class="ansi-green-intense-fg ansi-bold">   1601</span>     <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_exception <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>

File <span class="ansi-green-fg">~/miniconda3/envs/neurometry/lib/python3.9/site-packages/joblib/parallel.py:1699</span>, in <span class="ansi-cyan-fg">Parallel._retrieve</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   1692</span> <span class="ansi-bold" style="color: rgb(0,135,0)">while</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_wait_retrieval():
<span class="ansi-green-intense-fg ansi-bold">   1693</span>
<span class="ansi-green-intense-fg ansi-bold">   1694</span>     <span style="color: rgb(95,135,135)"># If the callback thread of a worker has signaled that its task</span>
<span class="ansi-green-intense-fg ansi-bold">   1695</span>     <span style="color: rgb(95,135,135)"># triggered an exception, or if the retrieval loop has raised an</span>
<span class="ansi-green-intense-fg ansi-bold">   1696</span>     <span style="color: rgb(95,135,135)"># exception (e.g. `GeneratorExit`), exit the loop and surface the</span>
<span class="ansi-green-intense-fg ansi-bold">   1697</span>     <span style="color: rgb(95,135,135)"># worker traceback.</span>
<span class="ansi-green-intense-fg ansi-bold">   1698</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_aborting:
<span class="ansi-green-fg">-&gt; 1699</span>         <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_raise_error_fast</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1700</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">break</span>
<span class="ansi-green-intense-fg ansi-bold">   1702</span>     <span style="color: rgb(95,135,135)"># If the next job is not ready for retrieval yet, we just wait for</span>
<span class="ansi-green-intense-fg ansi-bold">   1703</span>     <span style="color: rgb(95,135,135)"># async callbacks to progress.</span>

File <span class="ansi-green-fg">~/miniconda3/envs/neurometry/lib/python3.9/site-packages/joblib/parallel.py:1734</span>, in <span class="ansi-cyan-fg">Parallel._raise_error_fast</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   1730</span> <span style="color: rgb(95,135,135)"># If this error job exists, immediatly raise the error by</span>
<span class="ansi-green-intense-fg ansi-bold">   1731</span> <span style="color: rgb(95,135,135)"># calling get_result. This job might not exists if abort has been</span>
<span class="ansi-green-intense-fg ansi-bold">   1732</span> <span style="color: rgb(95,135,135)"># called directly or if the generator is gc&#39;ed.</span>
<span class="ansi-green-intense-fg ansi-bold">   1733</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> error_job <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-fg">-&gt; 1734</span>     <span class="ansi-yellow-bg">error_job</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">get_result</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">timeout</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/miniconda3/envs/neurometry/lib/python3.9/site-packages/joblib/parallel.py:736</span>, in <span class="ansi-cyan-fg">BatchCompletionCallBack.get_result</span><span class="ansi-blue-fg">(self, timeout)</span>
<span class="ansi-green-intense-fg ansi-bold">    730</span> backend <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>parallel<span style="color: rgb(98,98,98)">.</span>_backend
<span class="ansi-green-intense-fg ansi-bold">    732</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> backend<span style="color: rgb(98,98,98)">.</span>supports_retrieve_callback:
<span class="ansi-green-intense-fg ansi-bold">    733</span>     <span style="color: rgb(95,135,135)"># We assume that the result has already been retrieved by the</span>
<span class="ansi-green-intense-fg ansi-bold">    734</span>     <span style="color: rgb(95,135,135)"># callback thread, and is stored internally. It&#39;s just waiting to</span>
<span class="ansi-green-intense-fg ansi-bold">    735</span>     <span style="color: rgb(95,135,135)"># be returned.</span>
<span class="ansi-green-fg">--&gt; 736</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_return_or_raise</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    738</span> <span style="color: rgb(95,135,135)"># For other backends, the main thread needs to run the retrieval step.</span>
<span class="ansi-green-intense-fg ansi-bold">    739</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:

File <span class="ansi-green-fg">~/miniconda3/envs/neurometry/lib/python3.9/site-packages/joblib/parallel.py:754</span>, in <span class="ansi-cyan-fg">BatchCompletionCallBack._return_or_raise</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    752</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-intense-fg ansi-bold">    753</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>status <span style="color: rgb(98,98,98)">==</span> TASK_ERROR:
<span class="ansi-green-fg">--&gt; 754</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_result
<span class="ansi-green-intense-fg ansi-bold">    755</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_result
<span class="ansi-green-intense-fg ansi-bold">    756</span> <span class="ansi-bold" style="color: rgb(0,135,0)">finally</span>:

<span class="ansi-red-fg">QhullError</span>: QH6154 Qhull precision error: Initial simplex is flat (facet 1 is coplanar with the interior point)

While executing:  | qhull d Qt Q12 Qx Qc Qz Qbb
Options selected for Qhull 2019.1.r 2019/06/21:
  run-id 1336544124  delaunay  Qtriangulate  Q12-allow-wide  Qxact-merge
  Qcoplanar-keep  Qz-infinity-point  Qbbound-last  _zero-centrum
  Qinterior-keep  Q3-no-merge-vertices-dim-high  Pgood  _max-width 2.8e+02
  Error-roundoff 1.4e-11  _one-merge 1.2e-09  Visible-distance 8.6e-11
  U-max-coplanar 8.6e-11  Width-outside 1.7e-10  _wide-facet 5.2e-10
  _maxoutside 1.2e-09

precision problems (corrected unless &#39;Q0&#39; or an error)
     42 nearly singular or axis-parallel hyperplanes
      7 zero divisors during gaussian elimination

The input to qhull appears to be less than 41 dimensional, or a
computation has overflowed.

Qhull could not construct a clearly convex simplex from points:
- p14(v42): 1.6e+02    68 1e+02    91 1.6e+02 1e+02    40 1.5e+02 1.2e+02 1e+02 1.3e+02    71    85 1.2e+02    40    69    90    64 1.3e+02 1.1e+02 1e+02 1.1e+02    95 1.1e+02    95 1.3e+02    96    85    78    92 1e+02 1e+02 1.1e+02    73 1.2e+02    45    97    68    98    78    23
- p13(v41): 2e+02    41    64 1.1e+02 1.6e+02 1.1e+02 1.3e+02 1.2e+02 1.5e+02 1.3e+02 2e+02    48    71    51    56    44    45 1.4e+02 1.2e+02    91 1.2e+02 1.2e+02 1e+02    60    91 1.2e+02    84    90    99    74    99    69    72 1.2e+02 1.1e+02    82 1e+02    91 1.1e+02 1e+02    71
- p12(v40):  -3.9 1.4e+02 1.1e+02    22    40 1.3e+02 1.1e+02    24   1.3    32    77 1.1e+02 1.1e+02 1.7e+02 1.6e+02 1.8e+02 2e+02    47 1.4e+02 1.8e+02    98 1.2e+02    82    67    61 1.3e+02 1e+02    89    81    88    86    68 1e+02 1.1e+02 1e+02    74    85 1e+02 1.3e+02    93    76
- p11(v39): 1.9e+02    53    66 1.4e+02 1.5e+02 1e+02 1.3e+02 1.3e+02 1.6e+02 1.4e+02 1.8e+02    65    82    37    61    41    32 1.5e+02    95    64 1.2e+02 1.1e+02 1e+02    75 1e+02 1.1e+02    88 1e+02 1.1e+02    83 1e+02    86    78 1.2e+02 1e+02 1e+02    98    98 1.1e+02 1e+02    80
- p10(v38): 1.9e+02    54 1.2e+02 1.1e+02 1.8e+02    70   3.5 1.9e+02 1.7e+02 1.2e+02 1.2e+02    78    81 1e+02    19    42    50    65 1.2e+02    70    89    87 1.2e+02 1.8e+02 1.5e+02    74    93 1.1e+02 1.3e+02 1.3e+02    80 1.6e+02 1.1e+02    52 1.3e+02 1.1e+02 1.2e+02    77    79    76 1.2e+02
- p9(v37):    64    98    82    68    65 1.2e+02 1.8e+02    22    77    73 1.5e+02    89    86    72 1.6e+02 1.3e+02 1.1e+02 1.4e+02 1.1e+02 1.3e+02 1.1e+02 1.1e+02 1.1e+02    71 1e+02    66    84 1.1e+02 1.6e+02 1e+02    59    72    54 1.5e+02 1.1e+02 1.8e+02 1.1e+02 1.4e+02 1.3e+02 1.2e+02 1.1e+02
- p8(v36): 1e+02    79    97    54 1.1e+02 1.2e+02 1.2e+02    67    90    68 1.5e+02    74    77    99 1.2e+02 1.1e+02 1.1e+02    96 1.4e+02 1.4e+02 1e+02 1.2e+02 1.1e+02    95 1e+02    81    85 1e+02 1.4e+02 1.1e+02    62    86    68 1.1e+02 1.2e+02 1.4e+02 1.1e+02 1.2e+02 1.2e+02 1e+02    55
- p7(v35):    32 1.3e+02 1.2e+02    33    68 1.3e+02    73    60    18    45    81 1e+02 1e+02 1.8e+02 1.2e+02 1.6e+02 1.9e+02    32 1.4e+02 1.8e+02    99 1.2e+02    76    69    56 1.5e+02 1e+02    80    57    80 1e+02    71 1.2e+02    92 1e+02    34    80    83 1.2e+02    82    39
- p6(v34):    26 1.3e+02    86    44    46 1.4e+02 1.5e+02    16    13    54 1.2e+02    95 1e+02 1.4e+02 1.6e+02 1.6e+02 1.8e+02    86 1.3e+02 1.7e+02 1.1e+02 1.3e+02    76    20    42 1.5e+02    98    83    63    61 1e+02    36    93 1.3e+02    90    56    76 1e+02 1.4e+02 1e+02    59
- p4(v33): 1.2e+02    69    83    45 1.2e+02 1.4e+02 1.1e+02    69    74    68 1.8e+02    55    72 1.1e+02    98 1.1e+02 1.2e+02    83 1.5e+02 1.6e+02 1.1e+02 1.3e+02    96    49    67 1.3e+02    86    77    92    75    85    52    75 1.1e+02 1.2e+02    69    99    93 1.2e+02    99    32
- p3(v32): 1.4e+02    76    68 1.1e+02 1.1e+02 1.2e+02 1.5e+02    86 1.2e+02 1.2e+02 1.6e+02    75    88    59    98    77    71 1.5e+02 1e+02    94 1.2e+02 1.1e+02    97    54    87 1.2e+02    89 1e+02 1e+02    76 1e+02    68    77 1.3e+02    98    98    92 1.1e+02 1.2e+02 1.1e+02    42
- p2(v31): 2.1e+02    53    77 1.3e+02 1.8e+02 1e+02    56 1.8e+02 1.4e+02 1.4e+02 1.6e+02    57    88    95   4.3    34    60    91 1.2e+02    84 1.2e+02 1.1e+02    78    62    70 1.8e+02 1e+02    72    26    55 1.4e+02    79 1.2e+02    79    98   -22    76    44 1e+02    75    60
- p0(v30):   9.4 1.4e+02 1.3e+02    18    60 1.2e+02    62    53    14    30    63 1.1e+02 1e+02 1.9e+02 1.4e+02 1.7e+02 2e+02    20 1.4e+02 1.8e+02    89 1.1e+02    87 1e+02    75 1.2e+02 1e+02    89    87 1e+02    81    91 1.1e+02    86 1.1e+02    73    92    95 1.2e+02    83    69
- p20(v29):    19 1.5e+02    91 1.2e+02    24 1e+02 1.7e+02    40    62 1e+02    53 1.4e+02 1.3e+02    91 1.7e+02 1.4e+02 1.3e+02 1.4e+02    59    94 1.1e+02    94    86    72    91    96 1e+02 1.2e+02 1e+02    92 1e+02    89 1e+02 1.4e+02    75 1.3e+02    78 1.3e+02 1.2e+02 1.1e+02    75
- p1(v28):     3 1.5e+02 1.1e+02    30    44 1.4e+02    91    39  -6.7    40    68 1.1e+02 1.1e+02 1.9e+02 1.4e+02 1.8e+02 2.1e+02    34 1.3e+02 1.9e+02 1e+02 1.2e+02    67    48    40 1.6e+02 1.1e+02    77    40    69 1.1e+02    57 1.2e+02 1e+02    90    18    70    84 1.3e+02    84    67
- p35(v27): 1.3e+02    75 1.1e+02    48 1.4e+02 1.1e+02    31 1.2e+02    86    68 1.4e+02    69    80 1.5e+02    60    99 1.3e+02    34 1.6e+02 1.5e+02    98 1.2e+02    95 1e+02    84 1.3e+02    95    77    81    94    90    93 1.1e+02    70 1.2e+02    44 1e+02    70 1e+02    77    23
- p25(v26):    49 1e+02 1e+02    46    68 1.2e+02 1.4e+02    30    65    55 1.3e+02    94    86 1e+02 1.6e+02 1.4e+02 1.3e+02 1e+02 1.2e+02 1.4e+02 1e+02 1.1e+02 1.1e+02    94 1.1e+02    63    86 1.1e+02 1.6e+02 1.2e+02    53    86    64 1.3e+02 1.2e+02 1.7e+02 1.1e+02 1.4e+02 1.2e+02 1.1e+02    93
- p98(v25): 1.9e+02    61    61 1.7e+02 1.4e+02    93 1.5e+02 1.3e+02 1.7e+02 1.6e+02 1.6e+02    76    92    19    64    33    16 1.8e+02    70    38 1.3e+02    97 1e+02    73 1.1e+02 1.1e+02    91 1.1e+02 1e+02    81 1.1e+02    91    83 1.3e+02    93 1e+02    92 1e+02 1.1e+02 1.1e+02 1e+02
- p52(v24): 2e+02    47    45 1.6e+02 1.4e+02 1.1e+02 1.9e+02 1e+02 1.7e+02 1.6e+02 2e+02    60    79  -5.3    82    32   6.8 2e+02    79    48 1.3e+02 1.1e+02 1.1e+02    51 1.1e+02    97    82 1.1e+02 1.2e+02    76    99    70    57 1.5e+02    98 1.3e+02    99 1.2e+02 1.1e+02 1.2e+02 1.5e+02
- p84(v23): 1.8e+02 1.1e+02    62 2.3e+02 1.2e+02    77 1.2e+02 1.8e+02 1.6e+02 2.1e+02    72 1.2e+02 1.3e+02    48    33    31    29 1.7e+02    21   2.4 1.3e+02    83    59    51    75 1.8e+02 1.2e+02 1e+02   0.5    44 1.9e+02    95 1.5e+02 1.1e+02    49   -15    45    59    98    84 1.2e+02
- p43(v22): 1.7e+02 1e+02 1.1e+02 2.1e+02 1.3e+02    48    56 2e+02 1.8e+02 1.8e+02    32 1.3e+02 1.3e+02    67    30    36    26 1.3e+02    30  -4.4 1e+02    62    89 1.5e+02 1.4e+02 1e+02 1.1e+02 1.3e+02    76 1.1e+02 1.4e+02 1.6e+02 1.4e+02    73    80    71    79    75    77    77 1.3e+02
- p18(v21): 1.5e+02 1.1e+02 1e+02 2.1e+02 1.2e+02    51    85 1.8e+02 1.8e+02 1.8e+02    42 1.3e+02 1.3e+02    51    53    42    22 1.5e+02    27  -4.2 1e+02    62    97 1.5e+02 1.4e+02    83 1.1e+02 1.3e+02 1e+02 1.2e+02 1.2e+02 1.6e+02 1.3e+02    88    83 1.1e+02    86    93    82    87 1.3e+02
- p16(v20): 1.3e+02    76    46 1.2e+02    89 1.3e+02 2.2e+02    46 1.1e+02 1.2e+02 1.9e+02    70    86    29 1.3e+02    83    65 1.9e+02    92    94 1.3e+02 1.2e+02    97    16    76 1.2e+02    84 1e+02 1.1e+02    62    99    40    57 1.6e+02    90 1.2e+02    89 1.3e+02 1.3e+02 1.2e+02 1e+02
- p5(v19): 1.3e+02 1.2e+02    87 2e+02    93    70 1.1e+02 1.6e+02 1.4e+02 1.8e+02    38 1.3e+02 1.4e+02    68    67    63    54 1.5e+02    26    17 1.2e+02    75    74    95 1e+02 1.4e+02 1.2e+02 1.2e+02    47    79 1.5e+02 1.2e+02 1.4e+02 1e+02    62    47    62    81    95    86    72
- p44(v18):    85 1.3e+02    94 1.6e+02    71    82 1.3e+02 1e+02 1.2e+02 1.4e+02    56 1.3e+02 1.2e+02    72 1.1e+02    95    77 1.4e+02    48    52 1.1e+02    81    92 1.1e+02 1.1e+02    92 1.1e+02 1.3e+02 1e+02 1e+02 1.1e+02 1.2e+02 1.1e+02 1.2e+02    80 1.2e+02    83 1.1e+02 1e+02 1e+02    57
- p51(v17): 1.5e+02    60    89    74 1.4e+02 1.1e+02    96 1e+02 1.1e+02    90 1.7e+02    61    73    92    79    80    87    96 1.4e+02 1.2e+02 1.1e+02 1.2e+02 1.1e+02    87    97 1e+02    86    92 1.2e+02    95    79    84    76 1e+02 1.2e+02 1e+02 1.1e+02    97 1.1e+02    98    38
- p47(v16):    30 1.6e+02 1.1e+02 1.4e+02    41    87 1e+02    99    65 1.1e+02  -1.9 1.5e+02 1.4e+02 1.3e+02 1.2e+02 1.3e+02 1.4e+02    94    52    81 1e+02    83    69    96    85 1.3e+02 1.2e+02 1.1e+02    50    88 1.3e+02 1.1e+02 1.5e+02    98    66    52    62    90 1.1e+02    84    43
- p92(v15): 1.9e+02    56    78 1.6e+02 1.5e+02    78 1.3e+02 1.4e+02 1.9e+02 1.6e+02 1.5e+02    82    86    13    66    30   2.5 1.7e+02    70    27 1.1e+02    86 1.2e+02 1.2e+02 1.4e+02    58    86 1.3e+02 1.5e+02 1.2e+02    85 1.3e+02    73 1.2e+02 1.1e+02 1.7e+02 1.1e+02 1.2e+02    95 1.1e+02 1.6e+02
- p54(v14): 1.6e+02    98    99 1.9e+02 1.3e+02    64    64 1.9e+02 1.6e+02 1.7e+02    59 1.2e+02 1.2e+02    76    35    44    42 1.2e+02    50    22 1.1e+02    75    86 1.3e+02 1.2e+02 1.2e+02 1.1e+02 1.2e+02    67    96 1.4e+02 1.4e+02 1.4e+02    79    83    56    79    72    85    79    79
- p55(v13): 1.5e+02    49 1.2e+02    24 1.6e+02 1.1e+02    37 1.1e+02 1.1e+02    52 1.7e+02    51    58 1.3e+02    69    91 1.1e+02    41 1.8e+02 1.6e+02    92 1.2e+02 1.2e+02 1.3e+02 1.1e+02    82    81    86 1.4e+02 1.2e+02    50 1.1e+02    73    75 1.5e+02 1.2e+02 1.3e+02    93 1e+02    88    85
- p73(v12): 2.1e+02    46    66 1.7e+02 1.6e+02    85 1.3e+02 1.5e+02 1.9e+02 1.7e+02 1.7e+02    70    84    10    49    18  -2.6 1.8e+02    74    29 1.2e+02    93 1.1e+02    97 1.3e+02    88    87 1.2e+02 1.2e+02    95 1e+02 1.1e+02    77 1.2e+02 1e+02 1.3e+02 1e+02 1e+02    99 1.1e+02 1.5e+02
- p48(v11): 1.3e+02    58 1.1e+02   2.8 1.6e+02 1.3e+02    25 1e+02    67    38 1.8e+02    45    62 1.7e+02    63 1.1e+02 1.5e+02    11 1.9e+02 1.9e+02    97 1.4e+02 1e+02    88    72 1.4e+02    87    62    88    91    74    73    90    70 1.4e+02    41 1.1e+02    69 1.1e+02    79    63
- p100(v10): 1.1e+02    99    97 1.1e+02 1e+02 1e+02 1e+02 1e+02 1e+02 1.1e+02 1e+02    98 1e+02    97    96    96    95 1.1e+02    97    96 1.1e+02 1e+02    96    97 1e+02 1.1e+02    98 1.1e+02 1e+02    97    98 1e+02 1e+02 1e+02 1e+02    96    93    99 1.1e+02    95 2.4e+02
- p60(v9): 2e+02    59    84 1.1e+02 1.7e+02 1.1e+02    45 1.7e+02 1.2e+02 1.2e+02 1.5e+02    58    87 1.2e+02    13    50    82    71 1.3e+02 1.1e+02 1.2e+02 1.2e+02    77    63    64 1.8e+02 1e+02    68    25    57 1.4e+02    76 1.2e+02    75 1e+02   -26    77    43 1e+02    73    41
- p74(v8):  0.33 1.6e+02 1.2e+02    79    35 1e+02    91    64    30    70    17 1.4e+02 1.3e+02 1.6e+02 1.4e+02 1.6e+02 1.7e+02    61    90 1.3e+02    95    97    76    97    80 1.2e+02 1.1e+02 1.1e+02    70    97 1.1e+02 1e+02 1.3e+02    97    84    70    74    98 1.1e+02    86    51
- p96(v7):   5.7 1.5e+02 1.4e+02    63    49    98    63    75    39    58    17 1.4e+02 1.2e+02 1.7e+02 1.4e+02 1.6e+02 1.7e+02    42 1e+02 1.4e+02    85    94    87 1.3e+02    98    98 1.1e+02 1.1e+02    95 1.2e+02    89 1.2e+02 1.3e+02    84    99    95    89 1e+02 1.1e+02    82    64
- p81(v6): 2.2e+02    53    46 1.8e+02 1.6e+02 1e+02 1.4e+02 1.5e+02 1.7e+02 1.8e+02 1.8e+02    62    93    29    30    17    17 1.7e+02    76    42 1.4e+02 1.1e+02    81    33    75 1.7e+02    96    90    42    45 1.5e+02    65 1e+02 1.2e+02    81    20    71    70 1.1e+02    97 1.1e+02
- p86(v5):    30 1.5e+02 1.1e+02 1.5e+02    34    69 1.6e+02    70 1.1e+02 1.2e+02    19 1.6e+02 1.3e+02    62 1.6e+02 1.2e+02    82 1.6e+02    32    44    94    65 1.1e+02 1.5e+02 1.5e+02    21 1e+02 1.6e+02 1.7e+02 1.4e+02    74 1.5e+02    94 1.3e+02    89 2.2e+02 1e+02 1.5e+02 1e+02 1.1e+02 1.8e+02
- p19(v4):    46 1.2e+02    57    87    37 1.5e+02 2.2e+02   6.4    36    89 1.4e+02    94 1.1e+02    87 1.7e+02 1.4e+02 1.4e+02 1.5e+02    98 1.4e+02 1.3e+02 1.3e+02    75   -11    40 1.5e+02    95    93    64    45 1.1e+02    19    80 1.6e+02    75    71    68 1.2e+02 1.4e+02 1.2e+02    83
- p94(v3): 1.5e+02    45    87    25 1.5e+02 1.4e+02    84    84    85    58 2.1e+02    35    56 1.2e+02    76    93 1.2e+02    64 1.8e+02 1.7e+02 1.1e+02 1.4e+02 1e+02    60    72 1.3e+02    80    69 1e+02    80    73    54    68 1e+02 1.3e+02    69 1.1e+02    86 1.2e+02    95    59
- p46(v2): 2.4e+02    48    72 1.8e+02 1.9e+02    85    65 2e+02 1.9e+02 1.8e+02 1.5e+02    65    93    58  -9.6     5    17 1.3e+02    85    37 1.2e+02    99    84    81    92 1.6e+02 1e+02    88    39    64 1.5e+02 1e+02 1.2e+02    81    92   2.2    78    50    91    78 1.1e+02
- p79(v1):   -34 1.7e+02 1.2e+02    51     9 1.2e+02 1.3e+02    17   1.5    47    32 1.4e+02 1.2e+02 1.6e+02 1.8e+02 1.9e+02 2e+02    68 1e+02 1.6e+02    97 1.1e+02    79    76    71 1.1e+02 1.1e+02 1.1e+02    86    95    93    83 1.1e+02 1.2e+02    86    95    78 1.2e+02 1.3e+02    97    99

The center point is coplanar with a facet, or a vertex is coplanar
with a neighboring facet.  The maximum round off error for
computing distances is 1.4e-11.  The center point, facets and distances
to the center point are as follows:

center point    115.5    93.65    91.29    106.3    107.1    104.5    107.2    103.4    104.2    107.5    116.2    91.82     98.3    95.25    90.88    91.65    94.38    107.4      101    99.07    109.6    104.7    92.77    84.38    92.46      117    97.12    100.6    90.38    88.37    102.9    91.85    99.54      106    99.45     82.5     90.1    94.75    109.3    94.69    86.16

facet p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.8e-14
facet p14 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.4e-14
facet p14 p13 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -3.6e-14
facet p14 p13 p12 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -2.8e-14
facet p14 p13 p12 p11 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -2.1e-14
facet p14 p13 p12 p11 p10 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -2.6e-14
facet p14 p13 p12 p11 p10 p9 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -6.6e-15
facet p14 p13 p12 p11 p10 p9 p8 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -4.4e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.2e-16
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -4e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -6e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -4.6e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -5.3e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.6e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.7e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -3.9e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -2.6e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -6e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -4e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -8.3e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -9.1e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -2.6e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -2.3e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -9.3e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.1e-13
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -7.9e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -7.4e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.9e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -2.5e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -4.2e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -5e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p100 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.5e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p60 p74 p96 p81 p86 p19 p94 p46 p79 distance= -1.4e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p74 p96 p81 p86 p19 p94 p46 p79 distance= -5.4e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p96 p81 p86 p19 p94 p46 p79 distance= -4.4e-15
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p81 p86 p19 p94 p46 p79 distance= -1.2e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p86 p19 p94 p46 p79 distance= -7.4e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p19 p94 p46 p79 distance= -3.4e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p94 p46 p79 distance= -2.7e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p46 p79 distance= -1e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p79 distance= -3.2e-14
facet p14 p13 p12 p11 p10 p9 p8 p7 p6 p4 p3 p2 p0 p20 p1 p35 p25 p98 p52 p84 p43 p18 p16 p5 p44 p51 p47 p92 p54 p55 p73 p48 p100 p60 p74 p96 p81 p86 p19 p94 p46 distance= -1.4e-14

These points either have a maximum or minimum x-coordinate, or
they maximize the determinant for k coordinates.  Trial points
are first selected from points that maximize a coordinate.

Because of the high dimension, the min x-coordinate and max-coordinate
points are used if the determinant is non-zero.  Option &#39;Qs&#39; will
do a better, though much slower, job.  Instead of &#39;Qs&#39;, you can change
the points by randomly rotating the input with &#39;QR0&#39;.

The min and max coordinates for each dimension are:
  0:    -34.17     242.8  difference= 276.9
  1:     41.16     170.2  difference=  129
  2:     44.87     144.1  difference= 99.26
  3:    -8.179       233  difference= 241.1
  4:     8.965     188.5  difference= 179.5
  5:     47.84     145.2  difference= 97.33
  6:    -2.737     218.1  difference= 220.9
  7:    -12.18     204.8  difference=  217
  8:    -6.742     198.8  difference= 205.6
  9:     7.474     206.9  difference= 199.4
  10:    -19.73     213.7  difference= 233.4
  11:      34.9     158.6  difference= 123.7
  12:     56.27     147.8  difference= 91.56
  13:     -5.28     206.4  difference= 211.7
  14:    -9.578     192.3  difference= 201.9
  15:     4.992     190.1  difference= 185.2
  16:    -4.608     209.4  difference=  214
  17:     2.683     204.3  difference= 201.6
  18:        21     194.6  difference= 173.6
  19:    -4.403     199.5  difference= 203.9
  20:     80.48     136.5  difference= 56.07
  21:     62.07     138.9  difference= 76.82
  22:     59.19     129.1  difference= 69.96
  23:    -10.94     185.3  difference= 196.2
  24:     40.24     152.6  difference= 112.3
  25:     21.15     183.6  difference= 162.5
  26:     78.41     120.4  difference= 41.96
  27:     62.19     156.4  difference= 94.22
  28:    0.4971     179.8  difference= 179.3
  29:      43.8     143.4  difference= 99.65
  30:     36.92     185.1  difference= 148.2
  31:     19.33     178.3  difference=  159
  32:     44.23     156.2  difference=  112
  33:     51.54     163.7  difference= 112.1
  34:     48.53       150  difference= 101.5
  35:       -26     220.3  difference= 246.3
  36:     44.64     133.6  difference= 88.94
  37:     43.41     154.3  difference= 110.8
  38:     75.61     142.4  difference= 66.82
  39:     64.55     127.9  difference= 63.31
  40:         0     242.8  difference= 242.8

If the input should be full dimensional, you have several options that
may determine an initial simplex:
  - use &#39;QJ&#39;  to joggle the input and make it full dimensional
  - use &#39;QbB&#39; to scale the points to the unit cube
  - use &#39;QR0&#39; to randomly rotate the input for different maximum points
  - use &#39;Qs&#39;  to search all points for the initial simplex
  - use &#39;En&#39;  to specify a maximum roundoff error less than 1.4e-11.
  - trace execution with &#39;T3&#39; to see the determinant for each point.

If the input is lower dimensional:
  - use &#39;QJ&#39; to joggle the input and make it full dimensional
  - use &#39;Qbk:0Bk:0&#39; to delete coordinate k from the input.  You should
    pick the coordinate with the least range.  The hull will have the
    correct topology.
  - determine the flat containing the points, rotate the points
    into a coordinate plane, and delete the other coordinates.
  - add one or more points to make the input full dimensional.

</pre></div></div>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="01_methods_create_synthetic_data.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Create Synthetic Neural Manifolds</p>
      </div>
    </a>
    <a class="right-next"
       href="03_methods_estimate_manifold_topology.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Estimate Neural Topology</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Set-up-+-Imports">Set-up + Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Show-Methods-Implemented-in-\texttt{scikit-dimension}">Show Methods Implemented in <span class="math notranslate nohighlight">\(\texttt{scikit-dimension}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Define-Parameters-for-Experiments">Define Parameters for Experiments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Run-Experiments-for-Hyperspheres-with-\texttt{scikit-dimension}">Run Experiments for Hyperspheres with <span class="math notranslate nohighlight">\(\texttt{scikit-dimension}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Run-Experiments-for-Hypertori-with-\texttt{scikit-dimension}">Run Experiments for Hypertori with <span class="math notranslate nohighlight">\(\texttt{scikit-dimension}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Try-Single-Experiment">Try Single Experiment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#PLS-approach">PLS approach</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/notebooks/02_methods_estimate_manifold_dimension.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      Â© Copyright 2023, Geometric Intelligence Lab..
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>